"use strict";(self.webpackChunkhuomu=self.webpackChunkhuomu||[]).push([[56],{2525:function(se,m,e){e.r(m),e.d(m,{demos:function(){return re}});var J=e(59496),c=e(95281),re={}},21434:function(se,m,e){e.r(m),e.d(m,{demos:function(){return E}});var J=e(90228),c=e.n(J),re=e(87999),r=e.n(re),Z=e(59496),l=e(5758),E={"curd-demo-0":{component:Z.memo(Z.lazy(r()(c()().mark(function p(){var i,B;return c()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,Promise.resolve().then(e.bind(e,55492));case 2:return i=u.sent,B=i.Normal,u.abrupt("return",{default:B});case 5:case"end":return u.stop()}},p)})))),asset:{type:"BLOCK",id:"curd-demo-0",refAtomIds:["curd"],dependencies:{"index.tsx":{type:"FILE",value:`import { Normal } from './demo';

export default Normal;`},"./demo.tsx":{type:"FILE",value:e(32116).Z}},entry:"index.tsx"},context:{"./demo.tsx":e(55492)},renderOpts:{compile:function(){var p=r()(c()().mark(function B(){var P,u=arguments;return c()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,e.e(216).then(e.bind(e,20216));case 2:return o.abrupt("return",(P=o.sent).default.apply(P,u));case 3:case"end":return o.stop()}},B)}));function i(){return p.apply(this,arguments)}return i}()}},"curd-demo-1":{component:Z.memo(Z.lazy(r()(c()().mark(function p(){var i,B;return c()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,Promise.resolve().then(e.bind(e,55492));case 2:return i=u.sent,B=i.ReadDetail,u.abrupt("return",{default:B});case 5:case"end":return u.stop()}},p)})))),asset:{type:"BLOCK",id:"curd-demo-1",refAtomIds:["curd"],dependencies:{"index.tsx":{type:"FILE",value:`import { ReadDetail } from './demo';

export default ReadDetail;`},"./demo.tsx":{type:"FILE",value:e(32116).Z}},entry:"index.tsx"},context:{"./demo.tsx":e(55492)},renderOpts:{compile:function(){var p=r()(c()().mark(function B(){var P,u=arguments;return c()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,e.e(216).then(e.bind(e,20216));case 2:return o.abrupt("return",(P=o.sent).default.apply(P,u));case 3:case"end":return o.stop()}},B)}));function i(){return p.apply(this,arguments)}return i}()}},"curd-demo-2":{component:Z.memo(Z.lazy(r()(c()().mark(function p(){var i,B;return c()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,Promise.resolve().then(e.bind(e,55492));case 2:return i=u.sent,B=i.ReadDetail,u.abrupt("return",{default:B});case 5:case"end":return u.stop()}},p)})))),asset:{type:"BLOCK",id:"curd-demo-2",refAtomIds:["curd"],dependencies:{"index.tsx":{type:"FILE",value:`import { ReadDetail } from './demo';

export default ReadDetail;`},"./demo.tsx":{type:"FILE",value:e(32116).Z}},entry:"index.tsx"},context:{"./demo.tsx":e(55492)},renderOpts:{compile:function(){var p=r()(c()().mark(function B(){var P,u=arguments;return c()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,e.e(216).then(e.bind(e,20216));case 2:return o.abrupt("return",(P=o.sent).default.apply(P,u));case 3:case"end":return o.stop()}},B)}));function i(){return p.apply(this,arguments)}return i}()}},"curd-demo-3":{component:Z.memo(Z.lazy(r()(c()().mark(function p(){var i,B;return c()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,Promise.resolve().then(e.bind(e,55492));case 2:return i=u.sent,B=i.ActionRef,u.abrupt("return",{default:B});case 5:case"end":return u.stop()}},p)})))),asset:{type:"BLOCK",id:"curd-demo-3",refAtomIds:["curd"],dependencies:{"index.tsx":{type:"FILE",value:`import { ActionRef } from './demo';

export default ActionRef;`},"./demo.tsx":{type:"FILE",value:e(32116).Z}},entry:"index.tsx"},context:{"./demo.tsx":e(55492)},renderOpts:{compile:function(){var p=r()(c()().mark(function B(){var P,u=arguments;return c()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,e.e(216).then(e.bind(e,20216));case 2:return o.abrupt("return",(P=o.sent).default.apply(P,u));case 3:case"end":return o.stop()}},B)}));function i(){return p.apply(this,arguments)}return i}()}}}},26744:function(se,m,e){e.r(m),e.d(m,{demos:function(){return P}});var J=e(48305),c=e.n(J),re=e(26068),r=e.n(re),Z=e(90228),l=e.n(Z),E=e(87999),p=e.n(E),i=e(59496),B=e(90483),P={"use_curd_select-demo-0":{component:i.memo(i.lazy(p()(l()().mark(function u(){var g,o,F,k,d,I,ae,A,L,N,_;return l()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return N=function(){return N=p()(l()().mark(function z(K){var M;return l()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return console.log("fakeHMRequest",K),M=I,K.city&&(M=M.filter(function(x){return x.city===K.city})),C.abrupt("return",new Promise(function(x){setTimeout(function(){x({data:{data:M,success:!0,totalSize:100}})},1e3)}));case 4:case"end":return C.stop()}},z)})),N.apply(this,arguments)},L=function(z){return N.apply(this,arguments)},A=function(){return A=p()(l()().mark(function z(){return l()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return M.abrupt("return",["\u5E7F\u5DDE","\u6DF1\u5733"]);case 1:case"end":return M.stop()}},z)})),A.apply(this,arguments)},ae=function(){return A.apply(this,arguments)},O.next=6,Promise.resolve().then(e.bind(e,67541));case 6:return g=O.sent,o=g.CURD,F=g.useCURDSelect,O.next=11,Promise.resolve().then(e.bind(e,15337));case 11:return k=O.sent,d=k.range,I=d(5).map(function(j){return{id:"".concat(j),name:"name-".concat(j),city:void 0}}),I[0].city="\u5E7F\u5DDE",I[1].city="\u6DF1\u5733",_=function(){var z=F({initialValue:"",all:{label:"\u57CE\u5E02\uFF08\u5168\u90E8\uFF09",value:""},request:function(){var M=p()(l()().mark(function C(){var x;return l()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.next=2,ae();case 2:return x=T.sent,T.abrupt("return",x.map(function(G){return{label:G,value:G}})||[]);case 4:case"end":return T.stop()}},C)}));function b(){return M.apply(this,arguments)}return b}()}),K=[{title:"id",dataIndex:"id",search:!0},{title:"\u540D\u5B57",dataIndex:"name",search:!0},z.selectColumn({title:"\u57CE\u5E02",dataIndex:"city",search:!0}),{title:"city2",dataIndex:"city",search:!0,valueType:"select",request:function(){var M=p()(l()().mark(function C(){var x;return l()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.next=2,ae();case 2:return x=T.sent,T.abrupt("return",x.map(function(G){return{label:G,value:G}})||[]);case 4:case"end":return T.stop()}},C)}));function b(){return M.apply(this,arguments)}return b}()}];return i.createElement(o,{actions:[],hmTableProps:{hmColumns:K,hmRequest:L}})},O.abrupt("return",{default:_});case 18:case"end":return O.stop()}},u)})))),asset:{type:"BLOCK",id:"use_curd_select-demo-0",refAtomIds:["use_curd_select"],dependencies:{"index.tsx":{type:"FILE",value:`import { CURD, useCURDSelect } from '@huomu/core';
import { range } from 'lodash-es';

let fakeData = range(5).map((item) => ({
  id: \`\${item}\`,
  name: \`name-\${item}\`,
  city: undefined,
}));
fakeData[0].city = '\u5E7F\u5DDE';
fakeData[1].city = '\u6DF1\u5733';

async function fakeRequestCity() {
  return ['\u5E7F\u5DDE', '\u6DF1\u5733'];
}

async function fakeHMRequest(params) {
  console.log('fakeHMRequest', params);

  let data = fakeData;
  if (params.city) {
    data = data.filter((item) => item.city === params.city);
  }

  return new Promise((resolve) => {
    setTimeout(() => {
      resolve({
        data: {
          data: data,
          success: true,
          totalSize: 100,
        },
      });
    }, 1000);
  }) as Promise<any>;
}

const Demo = () => {
  const citySelect = useCURDSelect({
    initialValue: '',
    all: { label: '\u57CE\u5E02\uFF08\u5168\u90E8\uFF09', value: '' },
    request: async () => {
      const res = await fakeRequestCity();
      return (
        res.map((item) => ({
          label: item,
          value: item,
        })) || []
      );
    },
  });

  const hmColumns = [
    {
      title: 'id',
      dataIndex: 'id',
      search: true,
    },
    {
      title: '\u540D\u5B57',
      dataIndex: 'name',
      search: true,
    },
    citySelect.selectColumn({
      title: '\u57CE\u5E02',
      dataIndex: 'city',
      search: true,
    }),
    {
      title: 'city2',
      dataIndex: 'city',
      search: true,
      valueType: 'select',
      request: async () => {
        const res = await fakeRequestCity();

        return (
          res.map((item) => ({
            label: item,
            value: item,
          })) || []
        );
      },
    },
  ];

  return (
    <CURD
      actions={[]}
      hmTableProps={{
        hmColumns,
        hmRequest: fakeHMRequest,
      }}
    />
  );
};

export default Demo;`},"@huomu/core":{type:"NPM",value:"1.3.1"},"lodash-es":{type:"NPM",value:"4.17.21"}},entry:"index.tsx"},context:{"@huomu/core":e(67541),"lodash-es":e(15337)},renderOpts:{compile:function(){var u=p()(l()().mark(function o(){var F,k=arguments;return l()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return I.next=2,e.e(216).then(e.bind(e,20216));case 2:return I.abrupt("return",(F=I.sent).default.apply(F,k));case 3:case"end":return I.stop()}},o)}));function g(){return u.apply(this,arguments)}return g}()}},"use_curd_select-demo-1":{component:i.memo(i.lazy(p()(l()().mark(function u(){var g,o,F,k,d,I,ae,A,L,N,_,S,O,j,z,K;return l()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return z=function(){return z=p()(l()().mark(function x(Q){return l()().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:return console.log("fakeHMGetById",Q),G.abrupt("return",new Promise(function(f){setTimeout(function(){f({data:{data:L.find(function(D){return D.id===Q.id})}})},1e3)}));case 2:case"end":return G.stop()}},x)})),z.apply(this,arguments)},j=function(x){return z.apply(this,arguments)},O=function(){return O=p()(l()().mark(function x(Q){var T;return l()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return console.log("fakeHMRequest",Q),T=L,Q.city&&(T=T.filter(function(D){return D.city===Q.city})),f.abrupt("return",new Promise(function(D){setTimeout(function(){D({data:{data:T,success:!0,totalSize:100}})},1e3)}));case 4:case"end":return f.stop()}},x)})),O.apply(this,arguments)},S=function(x){return O.apply(this,arguments)},_=function(){return _=p()(l()().mark(function x(){return l()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.abrupt("return",["\u5E7F\u5DDE","\u6DF1\u5733"]);case 1:case"end":return T.stop()}},x)})),_.apply(this,arguments)},N=function(){return _.apply(this,arguments)},b.next=8,Promise.resolve().then(e.bind(e,67541));case 8:return g=b.sent,o=g.CURD,F=g.useCURDSelects,b.next=13,Promise.resolve().then(e.bind(e,15337));case 13:return k=b.sent,d=k.range,b.next=17,Promise.resolve().then(e.bind(e,98369));case 17:return I=b.sent,ae=I.ProFormText,A=I.ProFormSelect,L=d(5).map(function(C){return{id:"".concat(C),name:"name-".concat(C),city:void 0}}),L[0].city="\u5E7F\u5DDE",L[1].city="\u6DF1\u5733",K=function(){var x=F(function(){return{initialValue:"",all:{label:"\u57CE\u5E02\uFF08\u5168\u90E8\uFF09",value:""},request:function(){var f=p()(l()().mark(function ee(){var y;return l()().wrap(function(ue){for(;;)switch(ue.prev=ue.next){case 0:return ue.next=2,N();case 2:return y=ue.sent,ue.abrupt("return",y.map(function(he){return{label:he,value:he}})||[]);case 4:case"end":return ue.stop()}},ee)}));function D(){return f.apply(this,arguments)}return D}()}}),Q=x.tableCURDSelect,T=x.detailCURDSelect,G=[{title:"id",dataIndex:"id",search:!0},{title:"\u540D\u5B57",dataIndex:"name",search:!0},Q.selectColumn({title:"\u57CE\u5E02",dataIndex:"city",search:!0})];return i.createElement(o,{actions:["read"],hmTableProps:{hmColumns:G,hmRequest:S},renderForm:function(D){return i.createElement(i.Fragment,null,i.createElement(ae,r()(r()({},D),{},{name:"name",label:"\u540D\u5B57",required:!0,rules:[{required:!0}]})),i.createElement(ae,r()(r()({},D),{},{name:"age",label:" \u5E74\u9F84",required:!0})),i.createElement(A,r()({name:"city",label:"\u6240\u5C5E\u57CE\u5E02"},T.proFormSelectProps)))},requestGetById:j})},b.abrupt("return",{default:K});case 25:case"end":return b.stop()}},u)})))),asset:{type:"BLOCK",id:"use_curd_select-demo-1",refAtomIds:["use_curd_select"],dependencies:{"index.tsx":{type:"FILE",value:`import { CURD, useCURDSelects } from '@huomu/core';
import { range } from 'lodash-es';
import { ProFormText, ProFormSelect } from '@ant-design/pro-components';

let fakeData = range(5).map((item) => ({
  id: \`\${item}\`,
  name: \`name-\${item}\`,
  city: undefined,
}));
fakeData[0].city = '\u5E7F\u5DDE';
fakeData[1].city = '\u6DF1\u5733';

async function fakeRequestCity() {
  return ['\u5E7F\u5DDE', '\u6DF1\u5733'];
}

async function fakeHMRequest(params) {
  console.log('fakeHMRequest', params);

  let data = fakeData;
  if (params.city) {
    data = data.filter((item) => item.city === params.city);
  }

  return new Promise((resolve) => {
    setTimeout(() => {
      resolve({
        data: {
          data: data,
          success: true,
          totalSize: 100,
        },
      });
    }, 1000);
  }) as Promise<any>;
}

async function fakeHMGetById(params) {
  console.log('fakeHMGetById', params);

  return new Promise((resolve) => {
    setTimeout(() => {
      resolve({
        data: {
          data: fakeData.find((item) => item.id === params.id),
        },
      });
    }, 1000);
  });
}

const Demo = () => {
  const { tableCURDSelect, detailCURDSelect } = useCURDSelects(() => ({
    initialValue: '',
    all: { label: '\u57CE\u5E02\uFF08\u5168\u90E8\uFF09', value: '' },
    request: async () => {
      const res = await fakeRequestCity();
      return (
        res.map((item) => ({
          label: item,
          value: item,
        })) || []
      );
    },
  }));

  const hmColumns = [
    {
      title: 'id',
      dataIndex: 'id',
      search: true,
    },
    {
      title: '\u540D\u5B57',
      dataIndex: 'name',
      search: true,
    },
    tableCURDSelect.selectColumn({
      title: '\u57CE\u5E02',
      dataIndex: 'city',
      search: true,
    }),
  ];

  return (
    <CURD
      actions={['read']}
      hmTableProps={{
        hmColumns,
        hmRequest: fakeHMRequest,
      }}
      renderForm={(formProps) => (
        <>
          <ProFormText
            {...formProps}
            name="name"
            label="\u540D\u5B57"
            required
            rules={[{ required: true }]}
          />
          <ProFormText {...formProps} name="age" label=" \u5E74\u9F84" required />
          <ProFormSelect name="city" label={'\u6240\u5C5E\u57CE\u5E02'} {...detailCURDSelect.proFormSelectProps} />
        </>
      )}
      requestGetById={fakeHMGetById}
    />
  );
};

export default Demo;`},"@huomu/core":{type:"NPM",value:"1.3.1"},"lodash-es":{type:"NPM",value:"4.17.21"},"@ant-design/pro-components":{type:"NPM",value:"2.7.15"}},entry:"index.tsx"},context:{"@huomu/core":e(67541),"lodash-es":e(15337),"@ant-design/pro-components":e(98369)},renderOpts:{compile:function(){var u=p()(l()().mark(function o(){var F,k=arguments;return l()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return I.next=2,e.e(216).then(e.bind(e,20216));case 2:return I.abrupt("return",(F=I.sent).default.apply(F,k));case 3:case"end":return I.stop()}},o)}));function g(){return u.apply(this,arguments)}return g}()}},"use_curd_select-demo-2":{component:i.memo(i.lazy(p()(l()().mark(function u(){var g,o,F,k,d,I,ae,A,L,N,_,S,O,j,z,K,M,b,C,x,Q,T,G,f,D,ee,y,$,ue,he;return l()().wrap(function(q){for(;;)switch(q.prev=q.next){case 0:return ue=function(){return ue=p()(l()().mark(function X(W){return l()().wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:return console.log("fakeHMUpdateById",W),M=M.map(function(w){return w.id===W.id?r()(r()({},w),W):w}),Y.abrupt("return",Promise.resolve({}));case 3:case"end":return Y.stop()}},X)})),ue.apply(this,arguments)},$=function(X){return ue.apply(this,arguments)},y=function(){return y=p()(l()().mark(function X(W){return l()().wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:return console.log("fakeHMAdd",W),M.push(r()({id:M.length+1},W)),Y.abrupt("return",Promise.resolve({}));case 3:case"end":return Y.stop()}},X)})),y.apply(this,arguments)},ee=function(X){return y.apply(this,arguments)},D=function(){return D=p()(l()().mark(function X(W){return l()().wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:return console.log("fakeHMGetById",W),Y.abrupt("return",new Promise(function(w){setTimeout(function(){w({data:{data:M.find(function(me){return me.id===W.id})}})},1e3)}));case 2:case"end":return Y.stop()}},X)})),D.apply(this,arguments)},f=function(X){return D.apply(this,arguments)},G=function(){return G=p()(l()().mark(function X(W){var V;return l()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return console.log("fakeHMRequest",W),V=M,W.city&&(V=V.filter(function(me){return me.city===W.city})),W.area&&(V=V.filter(function(me){return me.area===W.area})),w.abrupt("return",new Promise(function(me){setTimeout(function(){me({data:{data:V,success:!0,totalSize:100}})},1e3)}));case 5:case"end":return w.stop()}},X)})),G.apply(this,arguments)},T=function(X){return G.apply(this,arguments)},Q=function(){return Q=p()(l()().mark(function X(W){var V;return l()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(V=W.city,!V){w.next=3;break}return w.abrupt("return",K[V]);case 3:return w.abrupt("return",z.apply(null,Object.values(K)));case 4:case"end":return w.stop()}},X)})),Q.apply(this,arguments)},x=function(X){return Q.apply(this,arguments)},C=function(){return C=p()(l()().mark(function X(){return l()().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return V.abrupt("return",Object.keys(K));case 1:case"end":return V.stop()}},X)})),C.apply(this,arguments)},b=function(){return C.apply(this,arguments)},q.next=14,Promise.resolve().then(e.t.bind(e,59496,19));case 14:return g=q.sent,o=g.useRef,q.next=18,Promise.resolve().then(e.bind(e,67541));case 18:return F=q.sent,k=F.CURD,d=F.useCURDSelects,q.next=23,Promise.resolve().then(e.bind(e,15337));case 23:return I=q.sent,ae=I.range,q.next=27,Promise.resolve().then(e.bind(e,47052));case 27:return A=q.sent,L=A.Button,q.next=31,Promise.resolve().then(e.bind(e,98369));case 31:return N=q.sent,_=N.ProForm,S=N.ProFormText,O=N.ProFormSelect,q.next=37,Promise.resolve().then(e.bind(e,15337));case 37:return j=q.sent,z=j.union,K={\u5E7F\u5DDE:["\u8D8A\u79C0","\u756A\u79BA"],\u6DF1\u5733:["\u798F\u7530","\u5357\u5C71"]},M=ae(5).map(function(le){return{id:"".concat(le),name:"name-".concat(le),city:void 0,area:void 0}}),M[0].city="\u5E7F\u5DDE",M[1].area="\u5357\u5C71",M[2].city="\u6DF1\u5733",M[2].area="\u798F\u7530",he=function(){var X=o(),W=_.useWatch("city",X.current),V=_.useForm(),Y=c()(V,1),w=Y[0],me=_.useWatch("city",w),Fe=d(function(){return{initialValue:"",all:{label:"\u57CE\u5E02\uFF08\u5168\u90E8\uFF09",value:""},request:function(){var Pe=p()(l()().mark(function ge(){var Me;return l()().wrap(function(fe){for(;;)switch(fe.prev=fe.next){case 0:return fe.next=2,b();case 2:return Me=fe.sent,fe.abrupt("return",Me.map(function(Re){return{label:Re,value:Re}})||[]);case 4:case"end":return fe.stop()}},ge)}));function ye(){return Pe.apply(this,arguments)}return ye}()}}),Ae=d(function(Pe){var ye=Pe.type,ge=ye==="table"?W:me;return{initialValue:"",all:{label:"\u533A\u57DF\uFF08\u5168\u90E8\uFF09",value:""},request:function(){var Me=p()(l()().mark(function fe(){var Re;return l()().wrap(function(Ce){for(;;)switch(Ce.prev=Ce.next){case 0:return Ce.next=2,x({city:ge});case 2:return Re=Ce.sent,Ce.abrupt("return",Re.map(function(Be){return{label:Be,value:Be}})||[]);case 4:case"end":return Ce.stop()}},fe)}));function xe(){return Me.apply(this,arguments)}return xe}(),useRequestOptions:{refreshDeps:[ge]}}}),$e=[{title:"id",dataIndex:"id",search:!0},{title:"\u540D\u5B57",dataIndex:"name",search:!0},Fe.tableCURDSelect.selectColumn({title:"\u57CE\u5E02",dataIndex:"city",search:!0}),Ae.tableCURDSelect.selectColumn({title:"\u533A\u57DF",dataIndex:"area",search:!0})];return i.createElement(k,{actions:["create","read","update"],hmTableProps:{formRef:X,hmColumns:$e,hmRequest:T},createButton:i.createElement(L,{type:"primary"},"\u65B0\u5EFA"),renderForm:function(ye){return i.createElement(i.Fragment,null,i.createElement(S,r()(r()({},ye),{},{name:"name",label:"\u540D\u5B57",required:!0,rules:[{required:!0}]})),i.createElement(S,r()(r()({},ye),{},{name:"age",label:" \u5E74\u9F84",required:!0})),i.createElement(O,r()({name:"city",label:"\u6240\u5C5E\u57CE\u5E02"},Fe.detailCURDSelect.proFormSelectProps)),i.createElement(O,r()({name:"area",label:"\u6240\u5C5E\u533A\u57DF"},Ae.detailCURDSelect.proFormSelectProps)))},renderFormInstance:w,requestGetById:f,requestAdd:ee,requestUpdateById:$})},q.abrupt("return",{default:he});case 47:case"end":return q.stop()}},u)})))),asset:{type:"BLOCK",id:"use_curd_select-demo-2",refAtomIds:["use_curd_select"],dependencies:{"index.tsx":{type:"FILE",value:`import { useRef } from 'react';
import { CURD, useCURDSelects } from '@huomu/core';
import { range } from 'lodash-es';
import { Button } from 'antd';
import { ProForm, ProFormText, ProFormSelect } from '@ant-design/pro-components';
import { union } from 'lodash-es';

const cityAreaData = {
  \u5E7F\u5DDE: ['\u8D8A\u79C0', '\u756A\u79BA'],
  \u6DF1\u5733: ['\u798F\u7530', '\u5357\u5C71'],
};
let fakeData = range(5).map((item) => ({
  id: \`\${item}\`,
  name: \`name-\${item}\`,
  city: undefined,
  area: undefined,
}));
fakeData[0].city = '\u5E7F\u5DDE';
fakeData[1].area = '\u5357\u5C71';
fakeData[2].city = '\u6DF1\u5733';
fakeData[2].area = '\u798F\u7530';

async function fakeRequestCity() {
  return Object.keys(cityAreaData);
}

async function fakeRequestArea({ city }: { city?: string }) {
  if (city) {
    return cityAreaData[city];
  }

  return union.apply(null, Object.values(cityAreaData));
}

async function fakeHMRequest(params) {
  console.log('fakeHMRequest', params);

  let data = fakeData;
  if (params.city) {
    data = data.filter((item) => item.city === params.city);
  }
  if (params.area) {
    data = data.filter((item) => item.area === params.area);
  }

  return new Promise((resolve) => {
    setTimeout(() => {
      resolve({
        data: {
          data: data,
          success: true,
          totalSize: 100,
        },
      });
    }, 1000);
  }) as Promise<any>;
}

async function fakeHMGetById(params) {
  console.log('fakeHMGetById', params);

  return new Promise((resolve) => {
    setTimeout(() => {
      resolve({
        data: {
          data: fakeData.find((item) => item.id === params.id),
        },
      });
    }, 1000);
  });
}

async function fakeHMAdd(params) {
  console.log('fakeHMAdd', params);

  fakeData.push({
    id: fakeData.length + 1,
    ...params,
  });

  return Promise.resolve({});
}

async function fakeHMUpdateById(params) {
  console.log('fakeHMUpdateById', params);

  fakeData = fakeData.map((item) => {
    if (item.id === params.id) {
      return {
        ...item,
        ...params,
      };
    }
    return item;
  });

  return Promise.resolve({});
}

const Demo = () => {
  const formRef = useRef<any>();
  const tableCity = ProForm.useWatch('city', formRef.current);

  const [renderFormInstance] = ProForm.useForm();
  const areaCity = ProForm.useWatch('city', renderFormInstance);

  const cityCURDSelects = useCURDSelects(() => ({
    initialValue: '',
    all: { label: '\u57CE\u5E02\uFF08\u5168\u90E8\uFF09', value: '' },
    request: async () => {
      const res = await fakeRequestCity();
      return (
        res.map((item) => ({
          label: item,
          value: item,
        })) || []
      );
    },
  }));

  const areaCURDSelects = useCURDSelects(({ type }) => {
    const city = type === 'table' ? tableCity : areaCity;

    return {
      initialValue: '',
      all: { label: '\u533A\u57DF\uFF08\u5168\u90E8\uFF09', value: '' },
      request: async () => {
        const res = await fakeRequestArea({ city });
        return (
          res.map((item) => ({
            label: item,
            value: item,
          })) || []
        );
      },
      useRequestOptions: {
        refreshDeps: [city],
      },
    };
  });

  const hmColumns = [
    {
      title: 'id',
      dataIndex: 'id',
      search: true,
    },
    {
      title: '\u540D\u5B57',
      dataIndex: 'name',
      search: true,
    },
    cityCURDSelects.tableCURDSelect.selectColumn({
      title: '\u57CE\u5E02',
      dataIndex: 'city',
      search: true,
    }),
    areaCURDSelects.tableCURDSelect.selectColumn({
      title: '\u533A\u57DF',
      dataIndex: 'area',
      search: true,
    }),
  ];

  return (
    <CURD
      actions={['create', 'read', 'update']}
      hmTableProps={{
        formRef,
        hmColumns,
        hmRequest: fakeHMRequest,
      }}
      createButton={<Button type="primary">\u65B0\u5EFA</Button>}
      renderForm={(formProps) => (
        <>
          <ProFormText
            {...formProps}
            name="name"
            label="\u540D\u5B57"
            required
            rules={[{ required: true }]}
          />
          <ProFormText {...formProps} name="age" label=" \u5E74\u9F84" required />
          <ProFormSelect
            name="city"
            label={'\u6240\u5C5E\u57CE\u5E02'}
            {...cityCURDSelects.detailCURDSelect.proFormSelectProps}
          />
          <ProFormSelect
            name="area"
            label={'\u6240\u5C5E\u533A\u57DF'}
            {...areaCURDSelects.detailCURDSelect.proFormSelectProps}
          />
        </>
      )}
      renderFormInstance={renderFormInstance}
      requestGetById={fakeHMGetById}
      requestAdd={fakeHMAdd}
      requestUpdateById={fakeHMUpdateById}
    />
  );
};

export default Demo;`},react:{type:"NPM",value:"17.0.2"},"@huomu/core":{type:"NPM",value:"1.3.1"},"lodash-es":{type:"NPM",value:"4.17.21"},antd:{type:"NPM",value:"5.20.0"},"@ant-design/pro-components":{type:"NPM",value:"2.7.15"}},entry:"index.tsx"},context:{react:e(59496),"@huomu/core":e(67541),"lodash-es":e(15337),antd:e(47052),"@ant-design/pro-components":e(98369)},renderOpts:{compile:function(){var u=p()(l()().mark(function o(){var F,k=arguments;return l()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return I.next=2,e.e(216).then(e.bind(e,20216));case 2:return I.abrupt("return",(F=I.sent).default.apply(F,k));case 3:case"end":return I.stop()}},o)}));function g(){return u.apply(this,arguments)}return g}()}}}},17636:function(se,m,e){e.r(m),e.d(m,{demos:function(){return E}});var J=e(90228),c=e.n(J),re=e(87999),r=e.n(re),Z=e(59496),l=e(71492),E={"value_type_map-demo-0":{component:Z.memo(Z.lazy(r()(c()().mark(function p(){var i,B,P,u,g,o,F,k,d,I,ae,A,L,N;return c()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return A=function(){return A=r()(c()().mark(function j(){var z;return c()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return z=k(5).map(function(b){return{id:"".concat(b),timeStr:"2024-10-01 10:00:00",timeNumber:+I("2024-10-01 10:00:00"),dateStr:"2024-10-01",dateNumber:+I("2024-10-01")}}),M.abrupt("return",Promise.resolve({data:{data:z,success:!0,totalSize:100}}));case 2:case"end":return M.stop()}},j)})),A.apply(this,arguments)},ae=function(){return A.apply(this,arguments)},S.next=4,Promise.resolve().then(e.bind(e,67541));case 4:return i=S.sent,B=i.CURD,P=i.customValueTypeMap,u=i.CustomValueTypeEnum,S.next=10,Promise.resolve().then(e.bind(e,98369));case 10:return g=S.sent,o=g.ProConfigProvider,S.next=14,Promise.resolve().then(e.bind(e,15337));case 14:return F=S.sent,k=F.range,S.next=18,Promise.resolve().then(e.t.bind(e,28026,23));case 18:return d=S.sent,I=d.default,L=function(){var j=[{title:"id",dataIndex:"id"},{title:"\u65F6\u95F4 str",dataIndex:"timeStr",valueType:u.CustomDateTimeAndDateRange,search:!0},{title:"\u65F6\u95F4 number",dataIndex:"timeNumber",valueType:u.CustomDateTimeAndDateRange,search:!0},{title:"\u65E5\u671F str",dataIndex:"dateStr",valueType:u.CustomDateAndDateRange,search:!0},{title:"\u65E5\u671F number",dataIndex:"dateNumber",valueType:u.CustomDateAndDateRange,search:!0}];return Z.createElement(B,{actions:[],hmTableProps:{hmColumns:j,hmRequest:ae}})},N=function(){return Z.createElement(o,{valueTypeMap:P},Z.createElement(L,null))},S.abrupt("return",{default:N});case 23:case"end":return S.stop()}},p)})))),asset:{type:"BLOCK",id:"value_type_map-demo-0",refAtomIds:["value_type_map"],dependencies:{"index.tsx":{type:"FILE",value:`import { CURD, customValueTypeMap, CustomValueTypeEnum } from '@huomu/core';
import { ProConfigProvider } from '@ant-design/pro-components';
import { range } from 'lodash-es';
import dayjs from 'dayjs';

async function fakeHMRequest() {
  const data = range(5).map((item) => ({
    id: \`\${item}\`,
    timeStr: \`2024-10-01 10:00:00\`,
    timeNumber: +dayjs('2024-10-01 10:00:00'),
    dateStr: \`2024-10-01\`,
    dateNumber: +dayjs('2024-10-01'),
  }));

  return Promise.resolve({
    data: {
      data,
      success: true,
      totalSize: 100,
    },
  }) as Promise<any>;
}

const Table = () => {
  const hmColumns: any[] = [
    {
      title: 'id',
      dataIndex: 'id',
    },
    {
      title: '\u65F6\u95F4 str',
      dataIndex: 'timeStr',
      valueType: CustomValueTypeEnum.CustomDateTimeAndDateRange,
      search: true,
    },
    {
      title: '\u65F6\u95F4 number',
      dataIndex: 'timeNumber',
      valueType: CustomValueTypeEnum.CustomDateTimeAndDateRange,
      search: true,
    },
    {
      title: '\u65E5\u671F str',
      dataIndex: 'dateStr',
      valueType: CustomValueTypeEnum.CustomDateAndDateRange,
      search: true,
    },
    {
      title: '\u65E5\u671F number',
      dataIndex: 'dateNumber',
      valueType: CustomValueTypeEnum.CustomDateAndDateRange,
      search: true,
    },
  ];

  return (
    <CURD
      actions={[]}
      hmTableProps={{
        hmColumns,
        hmRequest: fakeHMRequest,
      }}
    />
  );
};

const Demo = () => (
  <ProConfigProvider valueTypeMap={customValueTypeMap}>
    <Table />
  </ProConfigProvider>
);

export default Demo;`},"@huomu/core":{type:"NPM",value:"1.3.1"},"@ant-design/pro-components":{type:"NPM",value:"2.7.15"},"lodash-es":{type:"NPM",value:"4.17.21"},dayjs:{type:"NPM",value:"1.11.12"}},entry:"index.tsx"},context:{"@huomu/core":e(67541),"@ant-design/pro-components":e(98369),"lodash-es":e(15337),dayjs:e(28026)},renderOpts:{compile:function(){var p=r()(c()().mark(function B(){var P,u=arguments;return c()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,e.e(216).then(e.bind(e,20216));case 2:return o.abrupt("return",(P=o.sent).default.apply(P,u));case 3:case"end":return o.stop()}},B)}));function i(){return p.apply(this,arguments)}return i}()}}}},94815:function(se,m,e){e.r(m),e.d(m,{demos:function(){return re}});var J=e(59496),c=e(54392),re={}},61035:function(se,m,e){e.r(m),e.d(m,{demos:function(){return re}});var J=e(59496),c=e(26880),re={}},96700:function(se,m,e){e.r(m),e.d(m,{demos:function(){return re}});var J=e(59496),c=e(16606),re={}},55492:function(se,m,e){e.r(m),e.d(m,{ActionRef:function(){return G},Normal:function(){return x},ReadDetail:function(){return Q},Ref:function(){return T}});var J=e(48305),c=e.n(J),re=e(26068),r=e.n(re),Z=e(59496),l=e(67541),E=e(21941),p=e(68908),i=e(53992),B=e(90228),P=e.n(B),u=e(87999),g=e.n(u),o=e(62802),F={\u5E7F\u5DDE:["\u767D\u4E91","\u9EC4\u57D4","\u589E\u57CE"],\u6DF1\u5733:["\u798F\u7530","\u5357\u5C71","\u5B9D\u5B89"]};function k(f){return Math.floor(Math.random()*f)}function d(){return Object.keys(F)[k(Object.keys(F).length+1)]}function I(f){if(f.city)return f.city&&F[f.city][k(F[f.city].length+1)]}function ae(f){return(0,o.Z)(f).map(function(D){var ee=d(),y=I({city:ee});return{id:"".concat(D),name:"name-".concat(D),city:ee,area:y}})}var A=ae(100);function L(f){return N.apply(this,arguments)}function N(){return N=g()(P()().mark(function f(D){return P()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return console.log("fakeHMRequest",D),y.abrupt("return",new Promise(function($){setTimeout(function(){$({data:{data:A,success:!0,totalSize:A.length}})},1e3)}));case 2:case"end":return y.stop()}},f)})),N.apply(this,arguments)}function _(f){return S.apply(this,arguments)}function S(){return S=g()(P()().mark(function f(D){return P()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return console.log("fakeHMDeleteById",D),A=A.filter(function($){return $.id!==D.id}),y.abrupt("return",Promise.resolve({}));case 3:case"end":return y.stop()}},f)})),S.apply(this,arguments)}function O(f){return j.apply(this,arguments)}function j(){return j=g()(P()().mark(function f(D){return P()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return console.log("fakeHMGetById",D),y.abrupt("return",new Promise(function($){setTimeout(function(){$({data:{data:A.find(function(ue){return ue.id===D.id})}})},1e3)}));case 2:case"end":return y.stop()}},f)})),j.apply(this,arguments)}function z(f){return K.apply(this,arguments)}function K(){return K=g()(P()().mark(function f(D){return P()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return console.log("fakeHMAdd",D),A.push(r()({id:A.length+1},D)),y.abrupt("return",Promise.resolve({}));case 3:case"end":return y.stop()}},f)})),K.apply(this,arguments)}function M(f){return b.apply(this,arguments)}function b(){return b=g()(P()().mark(function f(D){return P()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return console.log("fakeHMUpdateById",D),A=A.map(function($){return $.id===D.id?r()(r()({},$),D):$}),y.abrupt("return",Promise.resolve({}));case 3:case"end":return y.stop()}},f)})),b.apply(this,arguments)}var C=e(4637),x=function(){var D=[{title:"id",dataIndex:"id",search:!0},{title:"\u540D\u5B57",dataIndex:"name",search:!0},{title:"city",dataIndex:"city"},{title:"area",dataIndex:"area"}];return(0,C.jsx)(l.CURD,{actions:["create","read","delete","update"],hmTableProps:{hmColumns:D,hmRequest:L},deleteProps:{nameIndex:"name",deleteById:_},renderForm:function(y){return(0,C.jsx)(C.Fragment,{children:(0,C.jsx)(p.Z,r()(r()({},y),{},{name:"name",label:"\u540D\u5B57",required:!0,rules:[{required:!0}]}))})},requestGetById:O,requestAdd:z,requestUpdateById:M})};function Q(){var f=[{title:"id",dataIndex:"id",search:!0},{title:"\u540D\u5B57",dataIndex:"name",search:!0}];return(0,C.jsx)(l.CURD,{actions:["read_detail"],hmTableProps:{hmColumns:f,hmRequest:L}})}function T(){var f=(0,Z.useRef)(),D=i.A.useForm(),ee=c()(D,1),y=ee[0],$=i.A.useWatch("name",f.current),ue=i.A.useWatch("name",y);console.log("name",$,"detailName",ue);var he=[{title:"id",dataIndex:"id",search:!0},{title:"\u540D\u5B57",dataIndex:"name",search:!0}];return(0,C.jsx)(l.CURD,{actions:["create","read_detail"],hmTableProps:{formRef:f,hmColumns:he,hmRequest:L},renderFormInstance:y,renderForm:function(q){return(0,C.jsx)(C.Fragment,{children:(0,C.jsx)(p.Z,r()(r()({},q),{},{name:"name",label:"\u540D\u5B57",required:!0,rules:[{required:!0}]}))})}})}function G(){var f=(0,Z.useRef)(),D=[{title:"id",dataIndex:"id",search:!0},{title:"\u540D\u5B57",dataIndex:"name",search:!0}];return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(E.ZP,{onClick:function(){var y;return(y=f.current.getActionRef().current)===null||y===void 0?void 0:y.reload()},children:"reload"}),(0,C.jsx)(l.CURD,{ref:f,actions:[],hmTableProps:{hmColumns:D,hmRequest:L}})]})}},67541:function(se,m,e){e.r(m),e.d(m,{CURD:function(){return x},CURDDetail:function(){return C},CustomValueTypeEnum:function(){return Se},EditorJSON:function(){return w},EditorJavascript:function(){return V},EditorMarkdown:function(){return $e},FileUpload:function(){return ge},HMDescriptions:function(){return he},HMTable:function(){return L},NumberSwitch:function(){return fe},OperateDelete:function(){return O},createStore:function(){return Ne},customValueTypeMap:function(){return we},getTableScroll:function(){return N},useCURDSelect:function(){return f},useCURDSelects:function(){return D},useDelete:function(){return S}});var J=e(15558),c=e.n(J),re=e(26068),r=e.n(re),Z=e(53570),l=e(21941),E=e(59496),p=e(5791),i=e(33553),B=e(90228),P=e.n(B),u=e(67825),g=e.n(u),o=e(87999),F=e.n(o),k=e(88216),d=e(4637),I=["current","pageSize"],ae=["hmRequest","request","hmColumns","columns","rowKey"];function A(n){return function(){var t=F()(P()().mark(function a(s){var h,v,R,U;return P()().wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:return h=s.current,v=s.pageSize,R=g()(s,I),ne.next=3,n(r()({page:h,pageSize:v},R));case 3:return U=ne.sent,ne.abrupt("return",{data:U.data.data,success:U.data.success,total:U.data.totalSize});case 5:case"end":return ne.stop()}},a)}));return function(a){return t.apply(this,arguments)}}()}function L(n){var t=n.hmRequest,a=n.request,s=n.hmColumns,h=n.columns,v=n.rowKey,R=v===void 0?"id":v,U=g()(n,ae),oe=(0,E.useCallback)(function(de){return t?A(t)(de):a(de,{},{})},[t,a]),ne=(0,E.useMemo)(function(){return s?s.map(function(de){return r()({search:!1},de)}):h},[h,s]);return(0,d.jsx)(k.Z,r()({cardBordered:!0,rowKey:R,pagination:r()({showSizeChanger:!0,showQuickJumper:!0},U.pagination),options:!1,request:oe,columns:ne},U))}function N(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:120,a={x:0,y:void 0};return n==null||n.forEach(function(s){s.hideInTable||(a.x+=Number(s.width)||t)}),a}var _=e(86725);function S(n){var t=n.name,a=n.desc,s=n.onDelete,h=(0,E.useCallback)(function(){_.Z.confirm({title:"\u786E\u8BA4\u5220\u9664 \u201C".concat(t,"\u201D \u5417\uFF1F"),content:a||"\u5220\u9664\u540E\u4E0D\u53EF\u6062\u590D\uFF0C\u8BF7\u8C28\u614E\u64CD\u4F5C",okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88",onOk:function(){s()}})},[t,a,s]);return{doDelete:h}}function O(n){var t=n.name,a=n.desc,s=n.onDelete,h=(0,E.useCallback)(function(){_.Z.confirm({title:"\u786E\u8BA4\u5220\u9664 \u201C".concat(t,"\u201D \u5417\uFF1F"),content:a||"\u5220\u9664\u540E\u4E0D\u53EF\u6062\u590D\uFF0C\u8BF7\u8C28\u614E\u64CD\u4F5C",okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88",onOk:function(){s()}})},[t,a,s]);return(0,d.jsx)("a",{style:{color:"red"},onClick:h,children:"\u5220\u9664"})}var j=e(48305),z=e.n(j),K=e(78293),M=e(53992),b=e(33417);function C(n){var t=n.action,a=n.id,s=n.record,h=n.trigger,v=n.onSuccess,R=n.renderForm,U=n.requestGetById,oe=n.requestGetByRecord,ne=n.requestAdd,de=n.requestUpdateById,Ee=n.renderFormInstance,pe=(0,E.useRef)(""+Math.random()),De=M.A.useForm(Ee),ve=z()(De,1),ie=ve[0],Ie=(0,E.useCallback)(function(){var Ue=F()(P()().mark(function te(ce){return P()().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:if(H.prev=0,!(t==="create"&&ne)){H.next=5;break}return H.next=4,ne(ce);case 4:K.ZP.open({type:"success",content:"\u521B\u5EFA\u6210\u529F"});case 5:if(!(t==="update"&&de)){H.next=9;break}return H.next=8,de(r()(r()({},ce),{},{id:a}));case 8:K.ZP.open({type:"success",content:"\u66F4\u65B0\u6210\u529F"});case 9:return v==null||v(),H.abrupt("return",!0);case 13:H.prev=13,H.t0=H.catch(0),setTimeout(function(){throw H.t0},10);case 16:case"end":return H.stop()}},te,null,[[0,13]])}));return function(te){return Ue.apply(this,arguments)}}(),[t,v,ne,de,a]),Oe=(0,E.useCallback)(function(Ue){if(Ue&&(ie==null||ie.resetFields(),a)){if(U)return U({id:a}).then(function(te){ie==null||ie.setFieldsValue(te.data.data)});if(oe)return oe(s).then(function(te){ie==null||ie.setFieldsValue(te.data.data)})}},[ie,a,U,oe,s]),Te=(0,E.useMemo)(function(){return R?R({readonly:t==="read"&&!!a},{action:t}):null},[t,a,R]);return(0,d.jsxs)(b.a,{form:ie,trigger:h,autoFocusFirstInput:!0,onFinish:Ie,onOpenChange:Oe,layout:"vertical",readonly:t==="read"&&!!a,children:[(0,d.jsx)("div",{className:"h-[20px]"}),Te]},a||pe.current)}var x=(0,E.forwardRef)(function(t,a){var s=t.actions,h=t.hmTableProps,v=t.createButton,R=t.deleteProps,U=t.detailIdIndex,oe=t.renderForm,ne=t.requestGetById,de=t.requestGetByRecord,Ee=t.requestAdd,pe=t.requestUpdateById,De=t.renderFormInstance,ve=(0,E.useRef)(),ie=(0,p.TH)();(0,E.useImperativeHandle)(a,function(){return{getActionRef:function(){return ve}}},[ve]);var Ie=(0,E.useMemo)(function(){return{renderForm:oe,requestGetById:ne,requestGetByRecord:de,requestAdd:Ee,requestUpdateById:pe,renderFormInstance:De}},[oe,Ee,ne,de,pe,De]),Oe=(0,E.useCallback)(function(te){return function(){if(R!=null&&R.deleteById)return R.deleteById({id:te.id,ids:[te.id]}).then(function(){var ce;(ce=ve.current)===null||ce===void 0||ce.reload()});if(R!=null&&R.deleteByRecord)return R.deleteByRecord(te).then(function(){var ce;(ce=ve.current)===null||ce===void 0||ce.reload()});throw new Error("\u6CA1\u6709\u4F20 deleteById or deleteByRecord")}},[R]),Te=(0,E.useCallback)(function(){var te;(te=ve.current)===null||te===void 0||te.reload()},[]),Ue=(0,E.useMemo)(function(){var te={title:"\u64CD\u4F5C",fixed:"right",width:120,render:function(Ze,H){return(0,d.jsxs)(Z.Z,{children:[s.includes("read")&&(0,d.jsx)(C,r()({id:H.id,record:H,onSuccess:Te,trigger:(0,d.jsx)("a",{children:"\u67E5\u770B"}),action:"read"},Ie),"read"+H.id),s.includes("read_detail")&&(0,d.jsx)(i.rU,{to:"".concat(ie.pathname,"/detail/").concat(H[U||"id"]),children:"\u67E5\u770B"}),s.includes("update")&&(0,d.jsx)(C,r()({id:H.id,record:H,onSuccess:Te,trigger:(0,d.jsx)("a",{children:"\u7F16\u8F91"}),action:"update"},Ie),"update"+H.id),s.includes("delete")&&R&&(0,d.jsx)(O,{name:H[R.nameIndex],desc:R.desc,onDelete:Oe(H)})]})}};return s.includes("read")||s.includes("read_detail")||s.includes("update")||s.includes("delete")?[].concat(c()(h.hmColumns||h.columns||[]),[te]):h.hmColumns},[s,R,U,Ie,Oe,Te,h.columns,h.hmColumns,ie.pathname]);return(0,d.jsx)("div",{className:"",children:(0,d.jsx)(L,r()(r()({rowKey:"id"},h),{},{scroll:N(Ue),actionRef:ve,toolBarRender:function(){return[].concat(c()(h.toolBarRender?h.toolBarRender.apply(h,arguments):[]),[s.includes("create")&&(0,d.jsx)(C,r()({onSuccess:Te,trigger:v||(0,d.jsx)(l.ZP,{type:"primary",children:"\u65B0\u5EFA"}),action:"create"},Ie),"create")])},search:r()({layout:"vertical",defaultCollapsed:!1},h.search),hmColumns:Ue}))})}),Q=e(46350),T=e(53213);function G(n){var t=n.initialValue,a=n.type,s=n.data,h=n.column,v=n.all,R=(0,E.useMemo)(function(){return a==="table"&&v?[v].concat(c()(s)):s},[v,s,a]);return a==="table"?(0,d.jsx)(Q.Z,{name:h.dataIndex,options:R,initialValue:t===void 0&&v?v.value:t,allowClear:!1}):null}function f(n){var t=n.all,a=n.request,s=n.useRequestOptions,h=n.initialValue,v=(0,T.Z)(function(){return a()},s),R=v.data,U=R===void 0?[]:R,oe=h===void 0&&t?t.value:h,ne=(0,E.useMemo)(function(){var pe={};return U.forEach(function(De){pe[De.value]={text:De.label}}),pe},[U]),de=(0,E.useCallback)(function(pe){return r()(r()({},pe),{},{valueEnum:ne,renderFormItem:function(ve,ie){var Ie=ie.type;return(0,d.jsx)(G,{type:Ie,data:U,column:pe,all:t,initialValue:oe})}})},[t,U,oe,ne]),Ee={options:U};return{selectColumn:de,proFormSelectProps:Ee}}function D(n){var t=(0,E.useMemo)(function(){return n({type:"table"})},[n]),a=(0,E.useMemo)(function(){return n({type:"detail"})},[n]),s=f(t),h=f(a);return{tableCURDSelect:s,detailCURDSelect:h}}var ee=e(66850),y=e(28026),$=e.n(y),ue=["hmItems","items"];function he(n){var t=n.hmItems,a=n.items,s=g()(n,ue),h=(0,E.useMemo)(function(){return t?t.map(function(v){var R=v.children;return v.children!==null&&v.children!==void 0&&(v.valueType==="date"?R=$()(R).format("YYYY-MM-DD"):v.valueType==="dateTime"?R=$()(R).format("YYYY-MM-DD HH:mm:ss"):v.valueType==="time"&&(R=$()(R).format("HH:mm:ss"))),r()(r()({},v),{},{children:R||"-"})}):a},[t,a]);return(0,d.jsx)(ee.Z,r()({items:h},s))}var be=e(34019),q=e(65273),le=e(59590),X=e(32479),W={width:"100%",height:"100%"};function V(n){var t=n.value,a=n.onChange,s=n.readonly;return(0,d.jsx)(be.ZP,{style:W,mode:"javascript",theme:"monokai",value:t,onChange:a,readOnly:s,name:"javascript_editor",editorProps:{$blockScrolling:!0},setOptions:{enableBasicAutocompletion:!0,enableLiveAutocompletion:!0,enableSnippets:!0,showLineNumbers:!0,tabSize:2}})}var Y=e(26494);function w(n){var t=n.value,a=n.onChange,s=n.readonly,h=(0,E.useRef)(null),v=(0,E.useRef)(null),R=(0,E.useRef)(a);return(0,E.useEffect)(function(){var U;(U=v.current)===null||U===void 0||U.update({text:t||""})},[t]),(0,E.useEffect)(function(){v.current=new Y.q9({target:h.current,props:{mode:Y.AR.text,readOnly:s,content:{text:t||""},onChange:function(oe){R.current(oe.text)}}})},[]),(0,d.jsx)("div",{ref:h,className:"h-full w-full"})}var me=e(70876),Fe=e(51709),Ae=["children","className","node"];function $e(n){var t=n.value;return(0,d.jsx)(me.U,{unwrapDisallowed:!0,components:{code:function(s){var h=s.children,v=s.className,R=s.node,U=g()(s,Ae),oe=/language-(\w+)/.exec(v||"");return oe?(0,d.jsx)(Fe.Z,r()(r()({},U),{},{PreTag:"div",wrapLongLines:!0,children:String(h).replace(/\n$/,""),language:oe[1].toLowerCase()})):(0,d.jsx)("code",r()(r()({},U),{},{className:v,children:h}))}},children:t||""})}var Pe=e(55860),ye=e(12592);function ge(n){var t=n.value,a=n.onChange,s=function(R){return a==null||a(R),!1},h=function(){a==null||a(void 0)};return(0,d.jsx)(d.Fragment,{children:(0,d.jsx)(ye.Z,{name:"file",maxCount:1,showUploadList:!0,fileList:t?[t]:void 0,beforeUpload:s,onRemove:h,children:(0,d.jsx)(l.ZP,{icon:(0,d.jsx)(Pe.Z,{}),children:"\u70B9\u51FB\u9009\u62E9\u6587\u4EF6"})})})}var Me=e(91880),xe=["value","onChange"];function fe(n){var t=n.value,a=n.onChange,s=g()(n,xe);return(0,d.jsx)(Me.Z,r()(r()({},s),{},{value:!!t,onChange:function(v){return a==null?void 0:a(Number(v))}}))}var Re=e(64934),je=e(65124),Ce=function(t){return function(a,s,h){var v=(0,je.mW)(t);return v(a,s,h)}},Be=Ce,Ne=function(t){return t?(0,Re.Ue)()(Be(t)):function(a){return(0,Re.Ue)()(Be(a))}},Ke=e(82092),He=e.n(Ke),Ge=e(85003),We=e(83873);function Ve(n){return(0,We.Z)(n)&&/^\d+$/.test(n)?$()(parseInt(n)):$()(n)}var Se=function(n){return n.CustomDateTimeAndDateRange="CustomDateTimeAndDateRange",n.CustomDateAndDateRange="CustomDateAndDateRange",n}(Se||{}),ke={dateTime:function(t){return t?(0,d.jsx)("div",{children:Ve(t).format("YYYY-MM-DD HH:mm:ss")}):"-"},date:function(t){return(0,d.jsx)("div",{children:t?$()(parseInt(t)).format("YYYY-MM-DD"):"-"})}},Le={dateRange:function(t,a){return(0,d.jsx)(Ge.Z,r()(r()({},a),{},{fieldProps:r()(r()({},a.fieldProps),{},{onChange:function(h){var v,R,U=h&&[$()(h[0]).startOf("day"),$()(h[1]).endOf("day")];(v=(R=a.fieldProps).onChange)===null||v===void 0||v.call(R,U)}})}))}},we=He()(He()({},Se.CustomDateTimeAndDateRange,{render:ke.dateTime,renderFormItem:Le.dateRange}),Se.CustomDateAndDateRange,{render:ke.date,renderFormItem:Le.dateRange})},28145:function(se,m,e){e.r(m),e.d(m,{texts:function(){return c}});var J=e(95281);const c=[{value:`// commitlint.config.js
module.exports = { extends: ['@huomu/commit-lint'] };
`,paraId:0,tocIndex:0}]},49097:function(se,m,e){e.r(m),e.d(m,{texts:function(){return c}});var J=e(5758);const c=[{value:"\u9700\u8981\u975E\u5E38\u4E86\u89E3 ant pro-components ProForm ProTable",paraId:0,tocIndex:0},{value:"\u57FA\u4E8E ant pro-components \u901A\u7528\u7684 CURD \u7EC4\u4EF6\uFF0C\u540C\u65F6\u4FDD\u7559\u6269\u5C55\u6027\u3002",paraId:1,tocIndex:0},{value:"\u8C03\u6574 actions \u4E3A ",paraId:2,tocIndex:3},{value:"['read_detail']",paraId:2,tocIndex:3},{value:"\uFF0C\u70B9\u51FB<\u67E5\u770B>\u8DF3\u8F6C\u5230 ",paraId:2,tocIndex:3},{value:"xxx/detail/[id]",paraId:2,tocIndex:3},{value:"\uFF0C",paraId:2,tocIndex:3},{value:"\u83B7\u53D6 ProTable \u7684 actionRef",paraId:3,tocIndex:4},{value:"\u901A\u8FC7 ref \u4F60\u53EF\u4EE5\u505A\u66F4\u591A\u64CD\u4F5C",paraId:4,tocIndex:5},{value:`/**
 * create \u521B\u5EFA
 * read \u67E5\u770B
 * read_detail \u8BE6\u60C5\u9875\u67E5\u770B
 * update \u7F16\u8F91
 * delete \u5220\u9664
 */
type CurdAction = 'create' | 'read' | 'read_detail' | 'update' | 'delete';

interface CURDProps {
  actions: CurdAction[];

  /** \u8868\u683C\u76F8\u5173 */
  hmTableProps: HMTableProps;

  /** \u5220\u9664\u76F8\u5173 */
  deleteProps?: {
    /** \u663E\u793A\u540D\u79F0\u7D22\u5F15 */
    nameIndex: string;
    /** \u5220\u9664\u63A5\u53E3 */
    deleteById?: ({ id, ids }) => Promise<any>;
    deleteByRecord?: (record) => Promise<any>;
    desc?: string;
  };

  /** \u65B0\u5EFA\u6309\u94AE\uFF0C\u9ED8\u8BA4\u65B0\u5EFA */
  createButton?: ReactNode;

  /** \u5F39\u7A97\u8868\u5355 */
  renderForm?: (formProps: { readonly: boolean }, info: { action: CurdAction }) => ReactNode;
  /** renderForm \u7684 formRef */
  renderFormInstance?: ProFormInstance;

  /** \u65B0\u589E\u63A5\u53E3 */
  requestAdd?: (values) => Promise<any>;
  /** \u66F4\u65B0\u63A5\u53E3 */
  requestUpdateById?: (values) => Promise<any>;

  /** \u83B7\u53D6\u8BE6\u60C5\u63A5\u53E3 */
  requestGetById?: ({ id }) => Promise<any>;
  /** \u83B7\u53D6\u8BE6\u60C5\u63A5\u53E3\uFF0C\u975E id \u7684\u65F6\u5019 */
  requestGetByRecord?: (record) => Promise<any>;

  /** \u8DF3\u8F6C\u5230\u8BE6\u60C5\u7684 id \u6240\u4EE5\uFF0C\u9ED8\u8BA4 id */
  detailIdIndex?: string;
}

interface CURDMethods {
  getActionRef: () => React.MutableRefObject<ActionType | undefined>;
}
`,paraId:5,tocIndex:6}]},81740:function(se,m,e){e.r(m),e.d(m,{texts:function(){return c}});var J=e(90483);const c=[{value:"\u9700\u8981\u975E\u5E38\u4E86\u89E3 ant pro-components ProForm ProTable",paraId:0,tocIndex:0},{value:"import { useCURDSelect, useCURDSelects } from '@huomu/core';",paraId:1,tocIndex:0},{value:"curd select \u7EC4\u4EF6\uFF0C\u6709",paraId:2,tocIndex:0},{value:"table \u7684 column",paraId:3,tocIndex:0},{value:"form \u7684 ProFormSelect",paraId:3,tocIndex:0},{value:"table detail \u7684\u6570\u636E\u5E94\u8BE5\u662F\u72EC\u7ACB\u7684\uFF0C\u6240\u4EE5\u7528 useCURDSelect \u6CA1\u6CD5\uFF0C\u56E0\u6B64\u6709 useCURDSelects",paraId:4,tocIndex:2},{value:"\u57CE\u5E02\u548C\u533A\u57DF\u8054\u52A8",paraId:5,tocIndex:3}]},96147:function(se,m,e){e.r(m),e.d(m,{texts:function(){return c}});var J=e(71492);const c=[{value:"\u81EA\u5B9A\u4E49 valueType",paraId:0,tocIndex:0},{value:`import { customValueTypeMap } from '@huomu/core';
import { ProConfigProvider } from '@ant-design/pro-components';

const Demo = () => (
  <ProConfigProvider valueTypeMap={customValueTypeMap}>
    <div>some</div>
  </ProConfigProvider>
);

export default Demo;
`,paraId:1,tocIndex:1}]},73690:function(se,m,e){e.r(m),e.d(m,{texts:function(){return c}});var J=e(54392);const c=[{value:`// .eslintrc.js
module.exports = {
  extends: ['@huomu/eslint-config-base'],
};
`,paraId:0,tocIndex:0}]},61799:function(se,m,e){e.r(m),e.d(m,{texts:function(){return c}});var J=e(26880);const c=[{value:`Usage: index [options] [command]

Options:
  -V, --version         output the version number
  -h, --help            display help for command

Commands:
  build_api [options]   swagger \u6587\u6863\u751F\u6210 API \u65B9\u6CD5
  build_enum [options]  \u6839\u636E\u679A\u4E3E\u751F\u6210\u4EE3\u7801
  help [command]        display help for command
`,paraId:0,tocIndex:0}]},30226:function(se,m,e){e.r(m),e.d(m,{texts:function(){return c}});var J=e(16606);const c=[{value:`// .stylelintrc.js
module.exports = {
  extends: ['@huomu/style-lint'],
};
`,paraId:0,tocIndex:0}]},32116:function(se,m){m.Z=`import React, { useRef } from 'react';
import { CURD } from '@huomu/core';
import { Button } from 'antd';
import { ProForm, ProFormText } from '@ant-design/pro-components';
import { fakeRequest, fakeDeleteById, fakeAdd, fakeGetById, fakeUpdateById } from './data';

const Normal = () => {
  const hmColumns = [
    {
      title: 'id',
      dataIndex: 'id',
      search: true,
    },
    {
      title: '\u540D\u5B57',
      dataIndex: 'name',
      search: true,
    },
    {
      title: 'city',
      dataIndex: 'city',
    },
    {
      title: 'area',
      dataIndex: 'area',
    },
  ];

  return (
    <CURD
      actions={['create', 'read', 'delete', 'update']}
      hmTableProps={{
        hmColumns,
        hmRequest: fakeRequest,
      }}
      deleteProps={{
        nameIndex: 'name',
        deleteById: fakeDeleteById,
      }}
      renderForm={(formProps) => (
        <>
          <ProFormText
            {...formProps}
            name="name"
            label="\u540D\u5B57"
            required
            rules={[{ required: true }]}
          />
        </>
      )}
      requestGetById={fakeGetById}
      requestAdd={fakeAdd}
      requestUpdateById={fakeUpdateById}
    />
  );
};

function ReadDetail() {
  const hmColumns = [
    {
      title: 'id',
      dataIndex: 'id',
      search: true,
    },
    {
      title: '\u540D\u5B57',
      dataIndex: 'name',
      search: true,
    },
  ];

  return (
    <CURD
      actions={['read_detail']}
      hmTableProps={{
        hmColumns,
        hmRequest: fakeRequest,
      }}
    />
  );
}

function Ref() {
  const formRef = useRef<any>();
  const [renderFormInstance] = ProForm.useForm();

  const name = ProForm.useWatch('name', formRef.current);
  const detailName = ProForm.useWatch('name', renderFormInstance);

  console.log('name', name, 'detailName', detailName);
  const hmColumns = [
    {
      title: 'id',
      dataIndex: 'id',
      search: true,
    },
    {
      title: '\u540D\u5B57',
      dataIndex: 'name',
      search: true,
    },
  ];

  return (
    <CURD
      actions={['create', 'read_detail']}
      hmTableProps={{
        formRef,
        hmColumns,
        hmRequest: fakeRequest,
      }}
      renderFormInstance={renderFormInstance}
      renderForm={(formProps) => (
        <>
          <ProFormText
            {...formProps}
            name="name"
            label="\u540D\u5B57"
            required
            rules={[{ required: true }]}
          />
        </>
      )}
    />
  );
}

function ActionRef() {
  const ref = useRef<any>();

  const hmColumns = [
    {
      title: 'id',
      dataIndex: 'id',
      search: true,
    },
    {
      title: '\u540D\u5B57',
      dataIndex: 'name',
      search: true,
    },
  ];

  return (
    <>
      <Button onClick={() => ref.current.getActionRef().current?.reload()}>reload</Button>
      <CURD
        ref={ref}
        actions={[]}
        hmTableProps={{
          hmColumns,
          hmRequest: fakeRequest,
        }}
      />
    </>
  );
}

export { Normal, ReadDetail, Ref, ActionRef };
`}}]);
