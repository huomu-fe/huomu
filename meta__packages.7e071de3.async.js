"use strict";(self.webpackChunkhuomu=self.webpackChunkhuomu||[]).push([[56],{2525:function(L,l,e){e.r(l),e.d(l,{demos:function(){return j}});var F=e(59496),r=e(95281),j={}},21434:function(L,l,e){e.r(l),e.d(l,{demos:function(){return C}});var F=e(90228),r=e.n(F),j=e(87999),o=e.n(j),T=e(59496),ne=e(5758),C={"curd-demo-0":{component:T.memo(T.lazy(o()(r()().mark(function R(){var y,v;return r()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Promise.resolve().then(e.bind(e,55492));case 2:return y=a.sent,v=y.Normal,a.abrupt("return",{default:v});case 5:case"end":return a.stop()}},R)})))),asset:{type:"BLOCK",id:"curd-demo-0",refAtomIds:["curd"],dependencies:{"index.tsx":{type:"FILE",value:`import { Normal } from './demo';

export default Normal;`},"./demo.tsx":{type:"FILE",value:e(32116).Z}},entry:"index.tsx"},context:{"./demo.tsx":e(55492)},renderOpts:{compile:function(){var R=o()(r()().mark(function v(){var I,a=arguments;return r()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,e.e(216).then(e.bind(e,20216));case 2:return s.abrupt("return",(I=s.sent).default.apply(I,a));case 3:case"end":return s.stop()}},v)}));function y(){return R.apply(this,arguments)}return y}()}},"curd-demo-1":{component:T.memo(T.lazy(o()(r()().mark(function R(){var y,v;return r()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Promise.resolve().then(e.bind(e,55492));case 2:return y=a.sent,v=y.ReadDetail,a.abrupt("return",{default:v});case 5:case"end":return a.stop()}},R)})))),asset:{type:"BLOCK",id:"curd-demo-1",refAtomIds:["curd"],dependencies:{"index.tsx":{type:"FILE",value:`import { ReadDetail } from './demo';

export default ReadDetail;`},"./demo.tsx":{type:"FILE",value:e(32116).Z}},entry:"index.tsx"},context:{"./demo.tsx":e(55492)},renderOpts:{compile:function(){var R=o()(r()().mark(function v(){var I,a=arguments;return r()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,e.e(216).then(e.bind(e,20216));case 2:return s.abrupt("return",(I=s.sent).default.apply(I,a));case 3:case"end":return s.stop()}},v)}));function y(){return R.apply(this,arguments)}return y}()}},"curd-demo-2":{component:T.memo(T.lazy(o()(r()().mark(function R(){var y,v;return r()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Promise.resolve().then(e.bind(e,55492));case 2:return y=a.sent,v=y.RemoteData,a.abrupt("return",{default:v});case 5:case"end":return a.stop()}},R)})))),asset:{type:"BLOCK",id:"curd-demo-2",refAtomIds:["curd"],dependencies:{"index.tsx":{type:"FILE",value:`import { RemoteData } from './demo';

export default RemoteData;`},"./demo.tsx":{type:"FILE",value:e(32116).Z}},entry:"index.tsx"},context:{"./demo.tsx":e(55492)},renderOpts:{compile:function(){var R=o()(r()().mark(function v(){var I,a=arguments;return r()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,e.e(216).then(e.bind(e,20216));case 2:return s.abrupt("return",(I=s.sent).default.apply(I,a));case 3:case"end":return s.stop()}},v)}));function y(){return R.apply(this,arguments)}return y}()}},"curd-demo-3":{component:T.memo(T.lazy(o()(r()().mark(function R(){var y,v;return r()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Promise.resolve().then(e.bind(e,55492));case 2:return y=a.sent,v=y.Ref,a.abrupt("return",{default:v});case 5:case"end":return a.stop()}},R)})))),asset:{type:"BLOCK",id:"curd-demo-3",refAtomIds:["curd"],dependencies:{"index.tsx":{type:"FILE",value:`import { Ref } from './demo';

export default Ref;`},"./demo.tsx":{type:"FILE",value:e(32116).Z}},entry:"index.tsx"},context:{"./demo.tsx":e(55492)},renderOpts:{compile:function(){var R=o()(r()().mark(function v(){var I,a=arguments;return r()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,e.e(216).then(e.bind(e,20216));case 2:return s.abrupt("return",(I=s.sent).default.apply(I,a));case 3:case"end":return s.stop()}},v)}));function y(){return R.apply(this,arguments)}return y}()}},"curd-demo-4":{component:T.memo(T.lazy(o()(r()().mark(function R(){var y,v;return r()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Promise.resolve().then(e.bind(e,55492));case 2:return y=a.sent,v=y.ActionRef,a.abrupt("return",{default:v});case 5:case"end":return a.stop()}},R)})))),asset:{type:"BLOCK",id:"curd-demo-4",refAtomIds:["curd"],dependencies:{"index.tsx":{type:"FILE",value:`import { ActionRef } from './demo';

export default ActionRef;`},"./demo.tsx":{type:"FILE",value:e(32116).Z}},entry:"index.tsx"},context:{"./demo.tsx":e(55492)},renderOpts:{compile:function(){var R=o()(r()().mark(function v(){var I,a=arguments;return r()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,e.e(216).then(e.bind(e,20216));case 2:return s.abrupt("return",(I=s.sent).default.apply(I,a));case 3:case"end":return s.stop()}},v)}));function y(){return R.apply(this,arguments)}return y}()}}}},17636:function(L,l,e){e.r(l),e.d(l,{demos:function(){return C}});var F=e(90228),r=e.n(F),j=e(87999),o=e.n(j),T=e(59496),ne=e(71492),C={"value_type_map-demo-0":{component:T.memo(T.lazy(o()(r()().mark(function R(){var y,v,I,a,B,s,K,Y,p,k,te,J,q,U;return r()().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return J=function(){return J=o()(r()().mark(function V(){var re;return r()().wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:return re=Y(5).map(function(ee){return{id:"".concat(ee),timeStr:"2024-10-01 10:00:00",timeNumber:+k("2024-10-01 10:00:00"),dateStr:"2024-10-01",dateNumber:+k("2024-10-01")}}),Q.abrupt("return",Promise.resolve({data:{data:re,success:!0,totalSize:100}}));case 2:case"end":return Q.stop()}},V)})),J.apply(this,arguments)},te=function(){return J.apply(this,arguments)},A.next=4,Promise.resolve().then(e.bind(e,80349));case 4:return y=A.sent,v=y.CURD,I=y.customValueTypeMap,a=y.CustomValueTypeEnum,A.next=10,Promise.resolve().then(e.bind(e,60714));case 10:return B=A.sent,s=B.ProConfigProvider,A.next=14,Promise.resolve().then(e.bind(e,15337));case 14:return K=A.sent,Y=K.range,A.next=18,Promise.resolve().then(e.t.bind(e,28026,23));case 18:return p=A.sent,k=p.default,q=function(){var V=[{title:"id",dataIndex:"id"},{title:"\u65F6\u95F4 str",dataIndex:"timeStr",valueType:a.CustomDateTimeAndDateRange,search:!0},{title:"\u65F6\u95F4 number",dataIndex:"timeNumber",valueType:a.CustomDateTimeAndDateRange,search:!0},{title:"\u65E5\u671F str",dataIndex:"dateStr",valueType:a.CustomDateAndDateRange,search:!0},{title:"\u65E5\u671F number",dataIndex:"dateNumber",valueType:a.CustomDateAndDateRange,search:!0}];return T.createElement(v,{actions:[],hmTableProps:{hmColumns:V,hmRequest:te}})},U=function(){return T.createElement(s,{valueTypeMap:I},T.createElement(q,null))},A.abrupt("return",{default:U});case 23:case"end":return A.stop()}},R)})))),asset:{type:"BLOCK",id:"value_type_map-demo-0",refAtomIds:["value_type_map"],dependencies:{"index.tsx":{type:"FILE",value:`import { CURD, customValueTypeMap, CustomValueTypeEnum } from '@huomu/core';
import { ProConfigProvider } from '@ant-design/pro-components';
import { range } from 'lodash-es';
import dayjs from 'dayjs';

async function fakeHMRequest() {
  const data = range(5).map((item) => ({
    id: \`\${item}\`,
    timeStr: \`2024-10-01 10:00:00\`,
    timeNumber: +dayjs('2024-10-01 10:00:00'),
    dateStr: \`2024-10-01\`,
    dateNumber: +dayjs('2024-10-01'),
  }));

  return Promise.resolve({
    data: {
      data,
      success: true,
      totalSize: 100,
    },
  }) as Promise<any>;
}

const Table = () => {
  const hmColumns: any[] = [
    {
      title: 'id',
      dataIndex: 'id',
    },
    {
      title: '\u65F6\u95F4 str',
      dataIndex: 'timeStr',
      valueType: CustomValueTypeEnum.CustomDateTimeAndDateRange,
      search: true,
    },
    {
      title: '\u65F6\u95F4 number',
      dataIndex: 'timeNumber',
      valueType: CustomValueTypeEnum.CustomDateTimeAndDateRange,
      search: true,
    },
    {
      title: '\u65E5\u671F str',
      dataIndex: 'dateStr',
      valueType: CustomValueTypeEnum.CustomDateAndDateRange,
      search: true,
    },
    {
      title: '\u65E5\u671F number',
      dataIndex: 'dateNumber',
      valueType: CustomValueTypeEnum.CustomDateAndDateRange,
      search: true,
    },
  ];

  return (
    <CURD
      actions={[]}
      hmTableProps={{
        hmColumns,
        hmRequest: fakeHMRequest,
      }}
    />
  );
};

const Demo = () => (
  <ProConfigProvider valueTypeMap={customValueTypeMap}>
    <Table />
  </ProConfigProvider>
);

export default Demo;`},"@huomu/core":{type:"NPM",value:"1.3.2"},"@ant-design/pro-components":{type:"NPM",value:"2.7.15"},"lodash-es":{type:"NPM",value:"4.17.21"},dayjs:{type:"NPM",value:"1.11.12"}},entry:"index.tsx"},context:{"@huomu/core":e(80349),"@ant-design/pro-components":e(60714),"lodash-es":e(15337),dayjs:e(28026)},renderOpts:{compile:function(){var R=o()(r()().mark(function v(){var I,a=arguments;return r()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,e.e(216).then(e.bind(e,20216));case 2:return s.abrupt("return",(I=s.sent).default.apply(I,a));case 3:case"end":return s.stop()}},v)}));function y(){return R.apply(this,arguments)}return y}()}}}},94815:function(L,l,e){e.r(l),e.d(l,{demos:function(){return j}});var F=e(59496),r=e(54392),j={}},61035:function(L,l,e){e.r(l),e.d(l,{demos:function(){return j}});var F=e(59496),r=e(26880),j={}},96700:function(L,l,e){e.r(l),e.d(l,{demos:function(){return j}});var F=e(59496),r=e(16606),j={}},55492:function(L,l,e){e.r(l),e.d(l,{ActionRef:function(){return ge},Normal:function(){return ye},ReadDetail:function(){return Re},Ref:function(){return Ie},RemoteData:function(){return Ce}});var F=e(90228),r=e.n(F),j=e(87999),o=e.n(j),T=e(48305),ne=e.n(T),C=e(26068),R=e.n(C),y=e(59496),v=e(80349),I=e(21941),a=e(68908),B=e(53992),s=e(62802),K={\u5E7F\u5DDE:["\u767D\u4E91","\u9EC4\u57D4","\u589E\u57CE"],\u6DF1\u5733:["\u798F\u7530","\u5357\u5C71","\u5B9D\u5B89"]},Y={HIGH:{text:"\u9AD8"},MEDIUM:{text:"\u4E2D"},LOW:{text:"\u4F4E"}};function p(m){return Math.floor(Math.random()*m)}function k(){return Object.keys(K)[p(Object.keys(K).length+1)]}function te(m){if(m.city)return m.city&&K[m.city][p(K[m.city].length+1)]}function J(){return Object.keys(Y)[p(Object.keys(Y).length+1)]}function q(m){return(0,s.Z)(m).map(function(g){var E=k(),i=te({city:E});return{id:"".concat(g),name:"name-".concat(g),city:E,area:i,level:J()}})}var U=q(100);function Z(m){return A.apply(this,arguments)}function A(){return A=o()(r()().mark(function m(g){return r()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return console.log("fakeHMRequest",g),i.abrupt("return",new Promise(function(M){setTimeout(function(){M({data:{data:U,success:!0,totalSize:U.length}})},1e3)}));case 2:case"end":return i.stop()}},m)})),A.apply(this,arguments)}function w(m){return V.apply(this,arguments)}function V(){return V=o()(r()().mark(function m(g){return r()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return console.log("fakeHMDeleteById",g),U=U.filter(function(M){return M.id!==g.id}),i.abrupt("return",Promise.resolve({}));case 3:case"end":return i.stop()}},m)})),V.apply(this,arguments)}function re(m){return _.apply(this,arguments)}function _(){return _=o()(r()().mark(function m(g){return r()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return console.log("fakeHMGetById",g),i.abrupt("return",new Promise(function(M){setTimeout(function(){M({data:{data:U.find(function(z){return z.id===g.id})}})},1e3)}));case 2:case"end":return i.stop()}},m)})),_.apply(this,arguments)}function Q(m){return ee.apply(this,arguments)}function ee(){return ee=o()(r()().mark(function m(g){return r()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return console.log("fakeHMAdd",g),U.push(R()({id:U.length+1},g)),i.abrupt("return",Promise.resolve({}));case 3:case"end":return i.stop()}},m)})),ee.apply(this,arguments)}function ae(m){return le.apply(this,arguments)}function le(){return le=o()(r()().mark(function m(g){return r()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return console.log("fakeHMUpdateById",g),U=U.map(function(M){return M.id===g.id?R()(R()({},M),g):M}),i.abrupt("return",Promise.resolve({}));case 3:case"end":return i.stop()}},m)})),le.apply(this,arguments)}function ve(){return Promise.resolve(Object.keys(K))}function pe(m){return m!=null&&m.city?Promise.resolve(K[m.city]):Promise.resolve(Object.values(K).reduce(function(g,E){return g.concat(E)},[]))}var P=e(4637),ye=function(){var g=[{title:"id",dataIndex:"id",search:!0},{title:"\u540D\u5B57",dataIndex:"name",search:!0},{title:"city",dataIndex:"city"},{title:"area",dataIndex:"area"}];return(0,P.jsx)(v.CURD,{actions:["create","read","delete","update"],hmTableProps:{hmColumns:g,hmRequest:Z},deleteProps:{nameIndex:"name",deleteById:w},detailForm:function(i){return(0,P.jsx)(P.Fragment,{children:(0,P.jsx)(a.Z,R()(R()({},i),{},{name:"name",label:"\u540D\u5B57",required:!0,rules:[{required:!0}]}))})},requestGetById:re,requestAdd:Q,requestUpdateById:ae})};function Re(){var m=[{title:"id",dataIndex:"id",search:!0},{title:"\u540D\u5B57",dataIndex:"name",search:!0}];return(0,P.jsx)(v.CURD,{actions:["read_detail"],hmTableProps:{hmColumns:m,hmRequest:Z}})}function Ie(){var m=(0,y.useRef)(),g=B.A.useForm(),E=ne()(g,1),i=E[0],M=B.A.useWatch("name",m.current),z=B.A.useWatch("name",i);console.log("useWatch",M,z);var H=[{title:"id",dataIndex:"id",search:!0},{title:"\u540D\u5B57",dataIndex:"name",search:!0}];return(0,P.jsx)(v.CURD,{actions:["create","read_detail"],hmTableProps:{formRef:m,hmColumns:H,hmRequest:Z},detailFormInstance:i,detailForm:function(ue){return(0,P.jsx)(P.Fragment,{children:(0,P.jsx)(a.Z,R()(R()({},ue),{},{name:"name",label:"\u540D\u5B57",required:!0,rules:[{required:!0}]}))})}})}function ge(){var m=(0,y.useRef)(),g=[{title:"id",dataIndex:"id",search:!0},{title:"\u540D\u5B57",dataIndex:"name",search:!0}];return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(I.ZP,{onClick:function(){var i;return(i=m.current.getActionRef().current)===null||i===void 0?void 0:i.reload()},children:"reload"}),(0,P.jsx)(v.CURD,{ref:m,actions:[],hmTableProps:{hmColumns:g,hmRequest:Z}})]})}function Ce(){var m=[{title:"id",dataIndex:"id",search:!0},{title:"\u540D\u5B57",dataIndex:"name",search:!0},{title:"\u7B49\u7EA7",dataIndex:"level",search:!0,valueEnum:Y},{title:"city",dataIndex:"city",search:!0,request:function(){var g=o()(r()().mark(function i(){var M;return r()().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return H.next=2,ve();case 2:return M=H.sent,H.abrupt("return",M.map(function(W){return{label:W,value:W}})||[]);case 4:case"end":return H.stop()}},i)}));function E(){return g.apply(this,arguments)}return E}()},{title:"area",dataIndex:"area",search:!0,request:function(){var g=o()(r()().mark(function i(M){var z;return r()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return console.log("params",M),W.next=3,pe(M);case 3:return z=W.sent,W.abrupt("return",z.map(function(ue){return{label:ue,value:ue}})||[]);case 5:case"end":return W.stop()}},i)}));function E(i){return g.apply(this,arguments)}return E}(),dependencies:["city"]}];return(0,P.jsx)(v.CURD,{actions:[],hmTableProps:{hmColumns:m,hmRequest:Z}})}},80349:function(L,l,e){e.r(l),e.d(l,{CURD:function(){return le},CURDDetail:function(){return ae},CustomValueTypeEnum:function(){return ie},EditorJSON:function(){return M},EditorJavascript:function(){return E},EditorMarkdown:function(){return ue},FileUpload:function(){return Ae},HMDescriptions:function(){return Re},HMTable:function(){return q},NumberSwitch:function(){return je},OperateDelete:function(){return w},createStore:function(){return Le},customValueTypeMap:function(){return He},getTableScroll:function(){return U},useDelete:function(){return A}});var F=e(15558),r=e.n(F),j=e(26068),o=e.n(j),T=e(73197),ne=e(21941),C=e(59496),R=e(5791),y=e(33553),v=e(90228),I=e.n(v),a=e(67825),B=e.n(a),s=e(87999),K=e.n(s),Y=e(19525),p=e(4637),k=["current","pageSize"],te=["hmRequest","request","hmColumns","columns","rowKey"];function J(n){return function(){var t=K()(I()().mark(function u(d){var c,f,h,D;return I()().wrap(function($){for(;;)switch($.prev=$.next){case 0:return c=d.current,f=d.pageSize,h=B()(d,k),$.next=3,n(o()({page:c,pageSize:f},h));case 3:return D=$.sent,$.abrupt("return",{data:D.data.data,success:D.data.success,total:D.data.totalSize});case 5:case"end":return $.stop()}},u)}));return function(u){return t.apply(this,arguments)}}()}function q(n){var t=n.hmRequest,u=n.request,d=n.hmColumns,c=n.columns,f=n.rowKey,h=f===void 0?"id":f,D=B()(n,te),N=(0,C.useCallback)(function(G){return t?J(t)(G):u(G,{},{})},[t,u]),$=(0,C.useMemo)(function(){return d?d.map(function(G){return o()({search:!1},G)}):c},[c,d]);return(0,p.jsx)(Y.Z,o()({cardBordered:!0,rowKey:h,pagination:o()({showSizeChanger:!0,showQuickJumper:!0},D.pagination),options:!1,request:N,columns:$},D))}function U(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:120,u={x:0,y:void 0};return n==null||n.forEach(function(d){d.hideInTable||(u.x+=Number(d.width)||t)}),u}var Z=e(90037);function A(n){var t=n.name,u=n.desc,d=n.onDelete,c=(0,C.useCallback)(function(){Z.Z.confirm({title:"\u786E\u8BA4\u5220\u9664 \u201C".concat(t,"\u201D \u5417\uFF1F"),content:u||"\u5220\u9664\u540E\u4E0D\u53EF\u6062\u590D\uFF0C\u8BF7\u8C28\u614E\u64CD\u4F5C",okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88",onOk:function(){d()}})},[t,u,d]);return{doDelete:c}}function w(n){var t=n.name,u=n.desc,d=n.onDelete,c=(0,C.useCallback)(function(){Z.Z.confirm({title:"\u786E\u8BA4\u5220\u9664 \u201C".concat(t,"\u201D \u5417\uFF1F"),content:u||"\u5220\u9664\u540E\u4E0D\u53EF\u6062\u590D\uFF0C\u8BF7\u8C28\u614E\u64CD\u4F5C",okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88",onOk:function(){d()}})},[t,u,d]);return(0,p.jsx)("a",{style:{color:"red"},onClick:c,children:"\u5220\u9664"})}var V=e(48305),re=e.n(V),_=e(75379),Q=e(53992),ee=e(33417);function ae(n){var t=n.action,u=n.id,d=n.record,c=n.trigger,f=n.onSuccess,h=n.detailForm,D=n.requestGetById,N=n.requestGetByRecord,$=n.requestAdd,G=n.requestUpdateById,me=n.detailFormInstance,ce=(0,C.useRef)(""+Math.random()),fe=Q.A.useForm(me),X=re()(fe,1),S=X[0],oe=(0,C.useCallback)(function(){var de=K()(I()().mark(function O(b){return I()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(x.prev=0,!(t==="create"&&$)){x.next=5;break}return x.next=4,$(b);case 4:_.ZP.open({type:"success",content:"\u521B\u5EFA\u6210\u529F"});case 5:if(!(t==="update"&&G)){x.next=9;break}return x.next=8,G(o()(o()({},b),{},{id:u}));case 8:_.ZP.open({type:"success",content:"\u66F4\u65B0\u6210\u529F"});case 9:return f==null||f(),x.abrupt("return",!0);case 13:x.prev=13,x.t0=x.catch(0),setTimeout(function(){throw x.t0},10);case 16:case"end":return x.stop()}},O,null,[[0,13]])}));return function(O){return de.apply(this,arguments)}}(),[t,f,$,G,u]),he=(0,C.useCallback)(function(de){if(de&&(S==null||S.resetFields(),u)){if(D)return D({id:u}).then(function(O){S==null||S.setFieldsValue(O.data.data)});if(N)return N(d).then(function(O){S==null||S.setFieldsValue(O.data.data)})}},[S,u,D,N,d]),se=(0,C.useMemo)(function(){return h?h({readonly:t==="read"&&!!u},{action:t}):null},[t,u,h]);return(0,p.jsxs)(ee.a,{form:S,trigger:c,autoFocusFirstInput:!0,onFinish:oe,onOpenChange:he,layout:"vertical",readonly:t==="read"&&!!u,children:[(0,p.jsx)("div",{className:"h-[20px]"}),se]},u||ce.current)}var le=(0,C.forwardRef)(function(t,u){var d=t.actions,c=t.hmTableProps,f=t.createButton,h=t.deleteProps,D=t.detailIdIndex,N=t.detailForm,$=t.requestGetById,G=t.requestGetByRecord,me=t.requestAdd,ce=t.requestUpdateById,fe=t.detailFormInstance,X=(0,C.useRef)(),S=(0,R.TH)();(0,C.useImperativeHandle)(u,function(){return{getActionRef:function(){return X}}},[X]);var oe=(0,C.useMemo)(function(){return{detailForm:N,requestGetById:$,requestGetByRecord:G,requestAdd:me,requestUpdateById:ce,detailFormInstance:fe}},[N,me,$,G,ce,fe]),he=(0,C.useCallback)(function(O){return function(){if(h!=null&&h.deleteById)return h.deleteById({id:O.id,ids:[O.id]}).then(function(){var b;(b=X.current)===null||b===void 0||b.reload()});if(h!=null&&h.deleteByRecord)return h.deleteByRecord(O).then(function(){var b;(b=X.current)===null||b===void 0||b.reload()});throw new Error("\u6CA1\u6709\u4F20 deleteById or deleteByRecord")}},[h]),se=(0,C.useCallback)(function(){var O;(O=X.current)===null||O===void 0||O.reload()},[]),de=(0,C.useMemo)(function(){var O={title:"\u64CD\u4F5C",fixed:"right",width:120,render:function(Ge,x){return(0,p.jsxs)(T.Z,{children:[d.includes("read")&&(0,p.jsx)(ae,o()({id:x.id,record:x,onSuccess:se,trigger:(0,p.jsx)("a",{children:"\u67E5\u770B"}),action:"read"},oe),"read"+x.id),d.includes("read_detail")&&(0,p.jsx)(y.rU,{to:"".concat(S.pathname,"/detail/").concat(x[D||"id"]),children:"\u67E5\u770B"}),d.includes("update")&&(0,p.jsx)(ae,o()({id:x.id,record:x,onSuccess:se,trigger:(0,p.jsx)("a",{children:"\u7F16\u8F91"}),action:"update"},oe),"update"+x.id),d.includes("delete")&&h&&(0,p.jsx)(w,{name:x[h.nameIndex],desc:h.desc,onDelete:he(x)})]})}};return d.includes("read")||d.includes("read_detail")||d.includes("update")||d.includes("delete")?[].concat(r()(c.hmColumns||c.columns||[]),[O]):c.hmColumns},[d,h,D,oe,he,se,c.columns,c.hmColumns,S.pathname]);return(0,p.jsx)("div",{className:"",children:(0,p.jsx)(q,o()(o()({rowKey:"id"},c),{},{scroll:U(de),actionRef:X,toolBarRender:function(){return[].concat(r()(c.toolBarRender?c.toolBarRender.apply(c,arguments):[]),[d.includes("create")&&(0,p.jsx)(ae,o()({onSuccess:se,trigger:f||(0,p.jsx)(ne.ZP,{type:"primary",children:"\u65B0\u5EFA"}),action:"create"},oe),"create")])},search:o()({layout:"vertical",defaultCollapsed:!1},c.search),hmColumns:de}))})}),ve=e(66850),pe=e(28026),P=e.n(pe),ye=["hmItems","items"];function Re(n){var t=n.hmItems,u=n.items,d=B()(n,ye),c=(0,C.useMemo)(function(){return t?t.map(function(f){var h=f.children;return f.children!==null&&f.children!==void 0&&(f.valueType==="date"?h=P()(h).format("YYYY-MM-DD"):f.valueType==="dateTime"?h=P()(h).format("YYYY-MM-DD HH:mm:ss"):f.valueType==="time"&&(h=P()(h).format("HH:mm:ss"))),o()(o()({},f),{},{children:h||"-"})}):u},[t,u]);return(0,p.jsx)(ve.Z,o()({items:c},d))}var Ie=e(34019),ge=e(65273),Ce=e(59590),m=e(32479),g={width:"100%",height:"100%"};function E(n){var t=n.value,u=n.onChange,d=n.readonly;return(0,p.jsx)(Ie.ZP,{style:g,mode:"javascript",theme:"monokai",value:t,onChange:u,readOnly:d,name:"javascript_editor",editorProps:{$blockScrolling:!0},setOptions:{enableBasicAutocompletion:!0,enableLiveAutocompletion:!0,enableSnippets:!0,showLineNumbers:!0,tabSize:2}})}var i=e(26494);function M(n){var t=n.value,u=n.onChange,d=n.readonly,c=(0,C.useRef)(null),f=(0,C.useRef)(null),h=(0,C.useRef)(u);return(0,C.useEffect)(function(){var D;(D=f.current)===null||D===void 0||D.update({text:t||""})},[t]),(0,C.useEffect)(function(){f.current=new i.q9({target:c.current,props:{mode:i.AR.text,readOnly:d,content:{text:t||""},onChange:function(N){h.current(N.text)}}})},[]),(0,p.jsx)("div",{ref:c,className:"h-full w-full"})}var z=e(70876),H=e(51709),W=["children","className","node"];function ue(n){var t=n.value;return(0,p.jsx)(z.U,{unwrapDisallowed:!0,components:{code:function(d){var c=d.children,f=d.className,h=d.node,D=B()(d,W),N=/language-(\w+)/.exec(f||"");return N?(0,p.jsx)(H.Z,o()(o()({},D),{},{PreTag:"div",wrapLongLines:!0,children:String(c).replace(/\n$/,""),language:N[1].toLowerCase()})):(0,p.jsx)("code",o()(o()({},D),{},{className:f,children:c}))}},children:t||""})}var Me=e(55860),Be=e(12592);function Ae(n){var t=n.value,u=n.onChange,d=function(h){return u==null||u(h),!1},c=function(){u==null||u(void 0)};return(0,p.jsx)(p.Fragment,{children:(0,p.jsx)(Be.Z,{name:"file",maxCount:1,showUploadList:!0,fileList:t?[t]:void 0,beforeUpload:d,onRemove:c,children:(0,p.jsx)(ne.ZP,{icon:(0,p.jsx)(Me.Z,{}),children:"\u70B9\u51FB\u9009\u62E9\u6587\u4EF6"})})})}var Oe=e(91880),Fe=["value","onChange"];function je(n){var t=n.value,u=n.onChange,d=B()(n,Fe);return(0,p.jsx)(Oe.Z,o()(o()({},d),{},{value:!!t,onChange:function(f){return u==null?void 0:u(Number(f))}}))}var De=e(64934),Ue=e(65124),$e=function(t){return function(u,d,c){var f=(0,Ue.mW)(t);return f(u,d,c)}},Pe=$e,Le=function(t){return t?(0,De.Ue)()(Pe(t)):function(u){return(0,De.Ue)()(Pe(u))}},Ne=e(82092),xe=e.n(Ne),Se=e(85003),Ke=e(83873);function We(n){return(0,Ke.Z)(n)&&/^\d+$/.test(n)?P()(parseInt(n)):P()(n)}var ie=function(n){return n.CustomDateTimeAndDateRange="CustomDateTimeAndDateRange",n.CustomDateAndDateRange="CustomDateAndDateRange",n}(ie||{}),Te={dateTime:function(t){return t?(0,p.jsx)("div",{children:We(t).format("YYYY-MM-DD HH:mm:ss")}):"-"},date:function(t){return(0,p.jsx)("div",{children:t?P()(parseInt(t)).format("YYYY-MM-DD"):"-"})}},Ee={dateRange:function(t,u){return(0,p.jsx)(Se.Z,o()(o()({},u),{},{fieldProps:o()(o()({},u.fieldProps),{},{onChange:function(c){var f,h,D=c&&[P()(c[0]).startOf("day"),P()(c[1]).endOf("day")];(f=(h=u.fieldProps).onChange)===null||f===void 0||f.call(h,D)}})}))}},He=xe()(xe()({},ie.CustomDateTimeAndDateRange,{render:Te.dateTime,renderFormItem:Ee.dateRange}),ie.CustomDateAndDateRange,{render:Te.date,renderFormItem:Ee.dateRange})},28145:function(L,l,e){e.r(l),e.d(l,{texts:function(){return r}});var F=e(95281);const r=[{value:`// commitlint.config.js
module.exports = { extends: ['@huomu/commit-lint'] };
`,paraId:0,tocIndex:0}]},49097:function(L,l,e){e.r(l),e.d(l,{texts:function(){return r}});var F=e(5758);const r=[{value:"\u9700\u8981\u975E\u5E38\u4E86\u89E3 ant pro-components ProForm ProTable",paraId:0,tocIndex:0},{value:"\u57FA\u4E8E ant pro-components \u901A\u7528\u7684 CURD \u7EC4\u4EF6\uFF0C\u540C\u65F6\u4FDD\u7559\u6269\u5C55\u6027\u3002",paraId:1,tocIndex:0},{value:"\u8C03\u6574 actions \u4E3A ",paraId:2,tocIndex:3},{value:"['read_detail']",paraId:2,tocIndex:3},{value:"\uFF0C\u70B9\u51FB<\u67E5\u770B>\u8DF3\u8F6C\u5230 ",paraId:2,tocIndex:3},{value:"xxx/detail/[id]",paraId:2,tocIndex:3},{value:"\uFF0C",paraId:2,tocIndex:3},{value:"\u83B7\u53D6 ProTable \u7684 actionRef",paraId:3,tocIndex:5},{value:"\u901A\u8FC7 ref \u4F60\u53EF\u4EE5\u505A\u66F4\u591A\u64CD\u4F5C",paraId:4,tocIndex:6},{value:`import type { ReactNode } from 'react';
import type { HMTableProps } from '../table';
import type { ProFormInstance, ActionType } from '@ant-design/pro-components';

/**
 * create \u521B\u5EFA
 * read \u67E5\u770B
 * read_detail \u8BE6\u60C5\u9875\u67E5\u770B
 * update \u7F16\u8F91
 * delete \u5220\u9664
 */
type CurdAction = 'create' | 'read' | 'read_detail' | 'update' | 'delete';

interface CURDProps {
  actions: CurdAction[];

  /** \u8868\u683C\u76F8\u5173 */
  hmTableProps: HMTableProps;

  /** \u5220\u9664\u76F8\u5173 */
  deleteProps?: {
    /** \u663E\u793A\u540D\u79F0\u7D22\u5F15 */
    nameIndex: string;
    /** \u5220\u9664\u63A5\u53E3 */
    deleteById?: ({ id, ids }) => Promise<any>;
    deleteByRecord?: (record) => Promise<any>;
    desc?: string;
  };

  /** \u65B0\u5EFA\u6309\u94AE\uFF0C\u9ED8\u8BA4\u65B0\u5EFA */
  createButton?: ReactNode;

  /** \u5F39\u7A97\u8868\u5355 */
  detailForm?: (formProps: { readonly: boolean }, info: { action: CurdAction }) => ReactNode;
  /** detailForm \u7684 formRef */
  detailFormInstance?: ProFormInstance;

  /** \u65B0\u589E\u63A5\u53E3 */
  requestAdd?: (values) => Promise<any>;
  /** \u66F4\u65B0\u63A5\u53E3 */
  requestUpdateById?: (values) => Promise<any>;

  /** \u83B7\u53D6\u8BE6\u60C5\u63A5\u53E3 */
  requestGetById?: ({ id }) => Promise<any>;
  /** \u83B7\u53D6\u8BE6\u60C5\u63A5\u53E3\uFF0C\u975E id \u7684\u65F6\u5019 */
  requestGetByRecord?: (record) => Promise<any>;

  /** \u8DF3\u8F6C\u5230\u8BE6\u60C5\u7684 id \u6240\u4EE5\uFF0C\u9ED8\u8BA4 id */
  detailIdIndex?: string;
}

interface CURDMethods {
  getActionRef: () => React.MutableRefObject<ActionType | undefined>;
}
`,paraId:5,tocIndex:7}]},96147:function(L,l,e){e.r(l),e.d(l,{texts:function(){return r}});var F=e(71492);const r=[{value:"\u81EA\u5B9A\u4E49 valueType",paraId:0,tocIndex:0},{value:`import { customValueTypeMap } from '@huomu/core';
import { ProConfigProvider } from '@ant-design/pro-components';

const Demo = () => (
  <ProConfigProvider valueTypeMap={customValueTypeMap}>
    <div>some</div>
  </ProConfigProvider>
);

export default Demo;
`,paraId:1,tocIndex:1}]},73690:function(L,l,e){e.r(l),e.d(l,{texts:function(){return r}});var F=e(54392);const r=[{value:`// .eslintrc.js
module.exports = {
  extends: ['@huomu/eslint-config-base'],
};
`,paraId:0,tocIndex:0}]},61799:function(L,l,e){e.r(l),e.d(l,{texts:function(){return r}});var F=e(26880);const r=[{value:`Usage: index [options] [command]

Options:
  -V, --version         output the version number
  -h, --help            display help for command

Commands:
  build_api [options]   swagger \u6587\u6863\u751F\u6210 API \u65B9\u6CD5
  build_enum [options]  \u6839\u636E\u679A\u4E3E\u751F\u6210\u4EE3\u7801
  help [command]        display help for command
`,paraId:0,tocIndex:0}]},30226:function(L,l,e){e.r(l),e.d(l,{texts:function(){return r}});var F=e(16606);const r=[{value:`// .stylelintrc.js
module.exports = {
  extends: ['@huomu/style-lint'],
};
`,paraId:0,tocIndex:0}]},32116:function(L,l){l.Z=`import React, { useRef } from 'react';
import { CURD } from '@huomu/core';
import { Button } from 'antd';
import { ProForm, ProFormText } from '@ant-design/pro-components';
import {
  fakeRequest,
  fakeDeleteById,
  fakeAdd,
  fakeGetById,
  fakeUpdateById,
  fakeRequestCity,
  fakeRequestArea,
  levels,
} from './data';

const Normal = () => {
  const hmColumns = [
    {
      title: 'id',
      dataIndex: 'id',
      search: true,
    },
    {
      title: '\u540D\u5B57',
      dataIndex: 'name',
      search: true,
    },
    {
      title: 'city',
      dataIndex: 'city',
    },
    {
      title: 'area',
      dataIndex: 'area',
    },
  ];

  return (
    <CURD
      actions={['create', 'read', 'delete', 'update']}
      hmTableProps={{
        hmColumns,
        hmRequest: fakeRequest,
      }}
      deleteProps={{
        nameIndex: 'name',
        deleteById: fakeDeleteById,
      }}
      detailForm={(formProps) => (
        <>
          <ProFormText
            {...formProps}
            name="name"
            label="\u540D\u5B57"
            required
            rules={[{ required: true }]}
          />
        </>
      )}
      requestGetById={fakeGetById}
      requestAdd={fakeAdd}
      requestUpdateById={fakeUpdateById}
    />
  );
};

function ReadDetail() {
  const hmColumns = [
    {
      title: 'id',
      dataIndex: 'id',
      search: true,
    },
    {
      title: '\u540D\u5B57',
      dataIndex: 'name',
      search: true,
    },
  ];

  return (
    <CURD
      actions={['read_detail']}
      hmTableProps={{
        hmColumns,
        hmRequest: fakeRequest,
      }}
    />
  );
}

function Ref() {
  const formRef = useRef<any>();
  const [detailFormInstance] = ProForm.useForm();

  const name = ProForm.useWatch('name', formRef.current);
  const detailName = ProForm.useWatch('name', detailFormInstance);

  console.log('useWatch', name, detailName);

  const hmColumns = [
    {
      title: 'id',
      dataIndex: 'id',
      search: true,
    },
    {
      title: '\u540D\u5B57',
      dataIndex: 'name',
      search: true,
    },
  ];

  return (
    <CURD
      actions={['create', 'read_detail']}
      hmTableProps={{
        formRef,
        hmColumns,
        hmRequest: fakeRequest,
      }}
      detailFormInstance={detailFormInstance}
      detailForm={(formProps) => (
        <>
          <ProFormText
            {...formProps}
            name="name"
            label="\u540D\u5B57"
            required
            rules={[{ required: true }]}
          />
        </>
      )}
    />
  );
}

function ActionRef() {
  const ref = useRef<any>();

  const hmColumns = [
    {
      title: 'id',
      dataIndex: 'id',
      search: true,
    },
    {
      title: '\u540D\u5B57',
      dataIndex: 'name',
      search: true,
    },
  ];

  return (
    <>
      <Button onClick={() => ref.current.getActionRef().current?.reload()}>reload</Button>
      <CURD
        ref={ref}
        actions={[]}
        hmTableProps={{
          hmColumns,
          hmRequest: fakeRequest,
        }}
      />
    </>
  );
}

function RemoteData() {
  const hmColumns = [
    {
      title: 'id',
      dataIndex: 'id',
      search: true,
    },
    {
      title: '\u540D\u5B57',
      dataIndex: 'name',
      search: true,
    },
    {
      title: '\u7B49\u7EA7',
      dataIndex: 'level',
      search: true,
      valueEnum: levels,
    },
    {
      title: 'city',
      dataIndex: 'city',
      search: true,
      request: async () => {
        const res = await fakeRequestCity();

        return (
          res.map((item) => ({
            label: item,
            value: item,
          })) || []
        );
      },
    },
    {
      title: 'area',
      dataIndex: 'area',
      search: true,
      request: async (params) => {
        console.log('params', params);
        const res = await fakeRequestArea(params);

        return (
          res.map((item) => ({
            label: item,
            value: item,
          })) || []
        );
      },
      dependencies: ['city'],
    },
  ];

  return (
    <CURD
      actions={[]}
      hmTableProps={{
        hmColumns,
        hmRequest: fakeRequest,
      }}
    />
  );
}

export { Normal, ReadDetail, Ref, ActionRef, RemoteData };
`}}]);
