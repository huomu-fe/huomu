"use strict";(self.webpackChunkhuomu=self.webpackChunkhuomu||[]).push([[56],{2525:function(U,l,e){e.r(l),e.d(l,{demos:function(){return O}});var B=e(59496),r=e(95281),O={}},21434:function(U,l,e){e.r(l),e.d(l,{demos:function(){return C}});var B=e(90228),r=e.n(B),O=e(87999),o=e.n(O),D=e(59496),ae=e(5758),C={"curd-demo-0":{component:D.memo(D.lazy(o()(r()().mark(function I(){var y,v;return r()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Promise.resolve().then(e.bind(e,55492));case 2:return y=a.sent,v=y.Normal,a.abrupt("return",{default:v});case 5:case"end":return a.stop()}},I)})))),asset:{type:"BLOCK",id:"curd-demo-0",refAtomIds:["curd"],dependencies:{"index.tsx":{type:"FILE",value:`import { Normal } from './demo';

export default Normal;`},"./demo.tsx":{type:"FILE",value:e(32116).Z}},entry:"index.tsx"},context:{"./demo.tsx":e(55492)},renderOpts:{compile:function(){var I=o()(r()().mark(function v(){var R,a=arguments;return r()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,e.e(216).then(e.bind(e,20216));case 2:return s.abrupt("return",(R=s.sent).default.apply(R,a));case 3:case"end":return s.stop()}},v)}));function y(){return I.apply(this,arguments)}return y}()}},"curd-demo-1":{component:D.memo(D.lazy(o()(r()().mark(function I(){var y,v;return r()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Promise.resolve().then(e.bind(e,55492));case 2:return y=a.sent,v=y.ReadDetail,a.abrupt("return",{default:v});case 5:case"end":return a.stop()}},I)})))),asset:{type:"BLOCK",id:"curd-demo-1",refAtomIds:["curd"],dependencies:{"index.tsx":{type:"FILE",value:`import { ReadDetail } from './demo';

export default ReadDetail;`},"./demo.tsx":{type:"FILE",value:e(32116).Z}},entry:"index.tsx"},context:{"./demo.tsx":e(55492)},renderOpts:{compile:function(){var I=o()(r()().mark(function v(){var R,a=arguments;return r()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,e.e(216).then(e.bind(e,20216));case 2:return s.abrupt("return",(R=s.sent).default.apply(R,a));case 3:case"end":return s.stop()}},v)}));function y(){return I.apply(this,arguments)}return y}()}},"curd-demo-2":{component:D.memo(D.lazy(o()(r()().mark(function I(){var y,v;return r()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Promise.resolve().then(e.bind(e,55492));case 2:return y=a.sent,v=y.RemoteData,a.abrupt("return",{default:v});case 5:case"end":return a.stop()}},I)})))),asset:{type:"BLOCK",id:"curd-demo-2",refAtomIds:["curd"],dependencies:{"index.tsx":{type:"FILE",value:`import { RemoteData } from './demo';

export default RemoteData;`},"./demo.tsx":{type:"FILE",value:e(32116).Z}},entry:"index.tsx"},context:{"./demo.tsx":e(55492)},renderOpts:{compile:function(){var I=o()(r()().mark(function v(){var R,a=arguments;return r()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,e.e(216).then(e.bind(e,20216));case 2:return s.abrupt("return",(R=s.sent).default.apply(R,a));case 3:case"end":return s.stop()}},v)}));function y(){return I.apply(this,arguments)}return y}()}},"curd-demo-3":{component:D.memo(D.lazy(o()(r()().mark(function I(){var y,v;return r()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Promise.resolve().then(e.bind(e,55492));case 2:return y=a.sent,v=y.Ref,a.abrupt("return",{default:v});case 5:case"end":return a.stop()}},I)})))),asset:{type:"BLOCK",id:"curd-demo-3",refAtomIds:["curd"],dependencies:{"index.tsx":{type:"FILE",value:`import { Ref } from './demo';

export default Ref;`},"./demo.tsx":{type:"FILE",value:e(32116).Z}},entry:"index.tsx"},context:{"./demo.tsx":e(55492)},renderOpts:{compile:function(){var I=o()(r()().mark(function v(){var R,a=arguments;return r()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,e.e(216).then(e.bind(e,20216));case 2:return s.abrupt("return",(R=s.sent).default.apply(R,a));case 3:case"end":return s.stop()}},v)}));function y(){return I.apply(this,arguments)}return y}()}},"curd-demo-4":{component:D.memo(D.lazy(o()(r()().mark(function I(){var y,v;return r()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Promise.resolve().then(e.bind(e,55492));case 2:return y=a.sent,v=y.ActionRef,a.abrupt("return",{default:v});case 5:case"end":return a.stop()}},I)})))),asset:{type:"BLOCK",id:"curd-demo-4",refAtomIds:["curd"],dependencies:{"index.tsx":{type:"FILE",value:`import { ActionRef } from './demo';

export default ActionRef;`},"./demo.tsx":{type:"FILE",value:e(32116).Z}},entry:"index.tsx"},context:{"./demo.tsx":e(55492)},renderOpts:{compile:function(){var I=o()(r()().mark(function v(){var R,a=arguments;return r()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,e.e(216).then(e.bind(e,20216));case 2:return s.abrupt("return",(R=s.sent).default.apply(R,a));case 3:case"end":return s.stop()}},v)}));function y(){return I.apply(this,arguments)}return y}()}}}},17636:function(U,l,e){e.r(l),e.d(l,{demos:function(){return C}});var B=e(90228),r=e.n(B),O=e(87999),o=e.n(O),D=e(59496),ae=e(71492),C={"value_type_map-demo-0":{component:D.memo(D.lazy(o()(r()().mark(function I(){var y,v,R,a,M,s,_,W,p,Z,ue,k,ee,ne;return r()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return k=function(){return k=o()(r()().mark(function te(){var J;return r()().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return J=W(5).map(function(se){return{id:"".concat(se),timeStr:"2024-10-01 10:00:00",timeNumber:+Z("2024-10-01 10:00:00"),dateStr:"2024-10-01",dateNumber:+Z("2024-10-01")}}),z.abrupt("return",Promise.resolve({data:{data:J,success:!0,totalSize:100}}));case 2:case"end":return z.stop()}},te)})),k.apply(this,arguments)},ue=function(){return k.apply(this,arguments)},x.next=4,Promise.resolve().then(e.bind(e,80349));case 4:return y=x.sent,v=y.CURD,R=y.customValueTypeMap,a=y.CustomValueTypeEnum,x.next=10,Promise.resolve().then(e.bind(e,47515));case 10:return M=x.sent,s=M.ProConfigProvider,x.next=14,Promise.resolve().then(e.bind(e,15337));case 14:return _=x.sent,W=_.range,x.next=18,Promise.resolve().then(e.t.bind(e,28026,23));case 18:return p=x.sent,Z=p.default,ee=function(){var te=[{title:"id",dataIndex:"id"},{title:"\u65F6\u95F4 str",dataIndex:"timeStr",valueType:a.CustomDateTimeAndDateRange,search:!0},{title:"\u65F6\u95F4 number",dataIndex:"timeNumber",valueType:a.CustomDateTimeAndDateRange,search:!0},{title:"\u65E5\u671F str",dataIndex:"dateStr",valueType:a.CustomDateAndDateRange,search:!0},{title:"\u65E5\u671F number",dataIndex:"dateNumber",valueType:a.CustomDateAndDateRange,search:!0}];return D.createElement(v,{actions:[],hmTableProps:{hmColumns:te,hmRequest:ue}})},ne=function(){return D.createElement(s,{valueTypeMap:R},D.createElement(ee,null))},x.abrupt("return",{default:ne});case 23:case"end":return x.stop()}},I)})))),asset:{type:"BLOCK",id:"value_type_map-demo-0",refAtomIds:["value_type_map"],dependencies:{"index.tsx":{type:"FILE",value:`import { CURD, customValueTypeMap, CustomValueTypeEnum } from '@huomu/core';
import { ProConfigProvider } from '@ant-design/pro-components';
import { range } from 'lodash-es';
import dayjs from 'dayjs';

async function fakeHMRequest() {
  const data = range(5).map((item) => ({
    id: \`\${item}\`,
    timeStr: \`2024-10-01 10:00:00\`,
    timeNumber: +dayjs('2024-10-01 10:00:00'),
    dateStr: \`2024-10-01\`,
    dateNumber: +dayjs('2024-10-01'),
  }));

  return Promise.resolve({
    data: {
      data,
      success: true,
      totalSize: 100,
    },
  }) as Promise<any>;
}

const Table = () => {
  const hmColumns: any[] = [
    {
      title: 'id',
      dataIndex: 'id',
    },
    {
      title: '\u65F6\u95F4 str',
      dataIndex: 'timeStr',
      valueType: CustomValueTypeEnum.CustomDateTimeAndDateRange,
      search: true,
    },
    {
      title: '\u65F6\u95F4 number',
      dataIndex: 'timeNumber',
      valueType: CustomValueTypeEnum.CustomDateTimeAndDateRange,
      search: true,
    },
    {
      title: '\u65E5\u671F str',
      dataIndex: 'dateStr',
      valueType: CustomValueTypeEnum.CustomDateAndDateRange,
      search: true,
    },
    {
      title: '\u65E5\u671F number',
      dataIndex: 'dateNumber',
      valueType: CustomValueTypeEnum.CustomDateAndDateRange,
      search: true,
    },
  ];

  return (
    <CURD
      actions={[]}
      hmTableProps={{
        hmColumns,
        hmRequest: fakeHMRequest,
      }}
    />
  );
};

const Demo = () => (
  <ProConfigProvider valueTypeMap={customValueTypeMap}>
    <Table />
  </ProConfigProvider>
);

export default Demo;`},"@huomu/core":{type:"NPM",value:"1.3.3"},"@ant-design/pro-components":{type:"NPM",value:"2.7.15"},"lodash-es":{type:"NPM",value:"4.17.21"},dayjs:{type:"NPM",value:"1.11.12"}},entry:"index.tsx"},context:{"@huomu/core":e(80349),"@ant-design/pro-components":e(47515),"lodash-es":e(15337),dayjs:e(28026)},renderOpts:{compile:function(){var I=o()(r()().mark(function v(){var R,a=arguments;return r()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,e.e(216).then(e.bind(e,20216));case 2:return s.abrupt("return",(R=s.sent).default.apply(R,a));case 3:case"end":return s.stop()}},v)}));function y(){return I.apply(this,arguments)}return y}()}}}},94815:function(U,l,e){e.r(l),e.d(l,{demos:function(){return O}});var B=e(59496),r=e(54392),O={}},61035:function(U,l,e){e.r(l),e.d(l,{demos:function(){return O}});var B=e(59496),r=e(26880),O={}},96700:function(U,l,e){e.r(l),e.d(l,{demos:function(){return O}});var B=e(59496),r=e(16606),O={}},55492:function(U,l,e){e.r(l),e.d(l,{ActionRef:function(){return De},Normal:function(){return ge},ReadDetail:function(){return Ce},Ref:function(){return Pe},RemoteData:function(){return xe}});var B=e(90228),r=e.n(B),O=e(87999),o=e.n(O),D=e(48305),ae=e.n(D),C=e(26068),I=e.n(C),y=e(59496),v=e(80349),R=e(21941),a=e(68908),M=e(53992),s=e(32282),_=e(62802),W={\u5E7F\u5DDE:["\u767D\u4E91","\u9EC4\u57D4","\u589E\u57CE"],\u6DF1\u5733:["\u798F\u7530","\u5357\u5C71","\u5B9D\u5B89"]},p={HIGH:{text:"\u9AD8"},MEDIUM:{text:"\u4E2D"},LOW:{text:"\u4F4E"}};function Z(m){return Math.floor(Math.random()*m)}function ue(){return Object.keys(W)[Z(Object.keys(W).length+1)]}function k(m){if(m.city)return m.city&&W[m.city][Z(W[m.city].length+1)]}function ee(){return Object.keys(p)[Z(Object.keys(p).length+1)]}function ne(m){return(0,_.Z)(m).map(function(g){var T=ue(),i=k({city:T});return{id:"".concat(g),name:"name-".concat(g),city:T,area:i,level:ee(),status:Z(2)===1}})}var S=ne(100);function x(m){return V.apply(this,arguments)}function V(){return V=o()(r()().mark(function m(g){return r()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return console.log("fakeHMRequest",g),i.abrupt("return",new Promise(function(E){setTimeout(function(){E({data:{data:S,success:!0,totalSize:S.length}})},1e3)}));case 2:case"end":return i.stop()}},m)})),V.apply(this,arguments)}function te(m){return J.apply(this,arguments)}function J(){return J=o()(r()().mark(function m(g){return r()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return console.log("fakeHMDeleteById",g),S=S.filter(function(E){return E.id!==g.id}),i.abrupt("return",Promise.resolve({}));case 3:case"end":return i.stop()}},m)})),J.apply(this,arguments)}function oe(m){return z.apply(this,arguments)}function z(){return z=o()(r()().mark(function m(g){return r()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return console.log("fakeHMGetById",g),i.abrupt("return",new Promise(function(E){setTimeout(function(){E({data:{data:S.find(function(Q){return Q.id===g.id})}})},1e3)}));case 2:case"end":return i.stop()}},m)})),z.apply(this,arguments)}function se(m){return q.apply(this,arguments)}function q(){return q=o()(r()().mark(function m(g){return r()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return console.log("fakeHMAdd",g),S.push(I()({id:S.length+1},g)),i.abrupt("return",Promise.resolve({}));case 3:case"end":return i.stop()}},m)})),q.apply(this,arguments)}function fe(m){return ie.apply(this,arguments)}function ie(){return ie=o()(r()().mark(function m(g){return r()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return console.log("fakeHMUpdateById",g),S=S.map(function(E){return E.id===g.id?I()(I()({},E),g):E}),i.abrupt("return",Promise.resolve({}));case 3:case"end":return i.stop()}},m)})),ie.apply(this,arguments)}function Re(){return Promise.resolve(Object.keys(W))}function Y(m){return m!=null&&m.city?Promise.resolve(W[m.city]):Promise.resolve(Object.values(W).reduce(function(g,T){return g.concat(T)},[]))}var A=e(4637),ge=function(){var g=[{title:"id",dataIndex:"id",search:!0},{title:"\u540D\u5B57",dataIndex:"name",search:!0},{title:"city",dataIndex:"city"},{title:"area",dataIndex:"area"}];return(0,A.jsx)(v.CURD,{actions:["create","read","delete","update"],hmTableProps:{hmColumns:g,hmRequest:x},deleteProps:{nameIndex:"name",deleteById:te},detailForm:function(i){return(0,A.jsx)(A.Fragment,{children:(0,A.jsx)(a.Z,I()(I()({},i),{},{name:"name",label:"\u540D\u5B57",required:!0,rules:[{required:!0}]}))})},requestGetById:oe,requestAdd:se,requestUpdateById:fe})};function Ce(){var m=[{title:"id",dataIndex:"id",search:!0},{title:"\u540D\u5B57",dataIndex:"name",search:!0}];return(0,A.jsx)(v.CURD,{actions:["read_detail"],hmTableProps:{hmColumns:m,hmRequest:x}})}function Pe(){var m=(0,y.useRef)(),g=M.A.useForm(),T=ae()(g,1),i=T[0];window._detailFormInstance=i;var E=M.A.useWatch("name",m.current),Q=M.A.useWatch("name",i);console.log("useWatch",E,Q);var H=[{title:"id",dataIndex:"id",search:!0},{title:"\u540D\u5B57",dataIndex:"name",search:!0}];return(0,A.jsx)(v.CURD,{actions:["create","read","update"],hmTableProps:{formRef:m,hmColumns:H,hmRequest:x},detailFormInstance:i,detailForm:function(re){return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(a.Z,I()(I()({},re),{},{name:"name",label:"\u540D\u5B57",required:!0,rules:[{required:!0}],initialValue:"default"})),(0,A.jsx)(s.Z,I()(I()({},re),{},{name:"status",label:"\u5F00\u542F",initialValue:!1}))]})},requestGetById:oe,requestAdd:se,requestUpdateById:fe})}function De(){var m=(0,y.useRef)(),g=[{title:"id",dataIndex:"id",search:!0},{title:"\u540D\u5B57",dataIndex:"name",search:!0}];return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(R.ZP,{onClick:function(){var i;return(i=m.current.getActionRef().current)===null||i===void 0?void 0:i.reload()},children:"reload"}),(0,A.jsx)(v.CURD,{ref:m,actions:[],hmTableProps:{hmColumns:g,hmRequest:x}})]})}function xe(){var m=[{title:"id",dataIndex:"id",search:!0},{title:"\u540D\u5B57",dataIndex:"name",search:!0},{title:"\u7B49\u7EA7",dataIndex:"level",search:!0,valueEnum:p},{title:"city",dataIndex:"city",search:!0,request:function(){var g=o()(r()().mark(function i(){var E;return r()().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return H.next=2,Re();case 2:return E=H.sent,H.abrupt("return",E.map(function(G){return{label:G,value:G}})||[]);case 4:case"end":return H.stop()}},i)}));function T(){return g.apply(this,arguments)}return T}()},{title:"area",dataIndex:"area",search:!0,request:function(){var g=o()(r()().mark(function i(E){var Q;return r()().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:return console.log("params",E),G.next=3,Y(E);case 3:return Q=G.sent,G.abrupt("return",Q.map(function(re){return{label:re,value:re}})||[]);case 5:case"end":return G.stop()}},i)}));function T(i){return g.apply(this,arguments)}return T}(),dependencies:["city"]}];return(0,A.jsx)(v.CURD,{actions:[],hmTableProps:{hmColumns:m,hmRequest:x}})}},80349:function(U,l,e){e.r(l),e.d(l,{CURD:function(){return fe},CURDDetail:function(){return q},CustomValueTypeEnum:function(){return he},EditorJSON:function(){return i},EditorJavascript:function(){return g},EditorMarkdown:function(){return G},FileUpload:function(){return je},HMDescriptions:function(){return ge},HMTable:function(){return ee},NumberSwitch:function(){return Le},OperateDelete:function(){return V},createStore:function(){return Ke},customValueTypeMap:function(){return Ze},getTableScroll:function(){return ne},useDelete:function(){return x}});var B=e(15558),r=e.n(B),O=e(26068),o=e.n(O),D=e(73197),ae=e(21941),C=e(59496),I=e(5791),y=e(33553),v=e(90228),R=e.n(v),a=e(67825),M=e.n(a),s=e(87999),_=e.n(s),W=e(19525),p=e(4637),Z=["current","pageSize"],ue=["hmRequest","request","hmColumns","columns","rowKey"];function k(n){return function(){var t=_()(R()().mark(function u(d){var c,f,h,P;return R()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return c=d.current,f=d.pageSize,h=M()(d,Z),j.next=3,n(o()({page:c,pageSize:f},h));case 3:return P=j.sent,j.abrupt("return",{data:P.data.data,success:P.data.success,total:P.data.totalSize});case 5:case"end":return j.stop()}},u)}));return function(u){return t.apply(this,arguments)}}()}function ee(n){var t=n.hmRequest,u=n.request,d=n.hmColumns,c=n.columns,f=n.rowKey,h=f===void 0?"id":f,P=M()(n,ue),$=(0,C.useCallback)(function(b){return t?k(t)(b):u(b,{},{})},[t,u]),j=(0,C.useMemo)(function(){return d?d.map(function(b){return o()({search:!1},b)}):c},[c,d]);return(0,p.jsx)(W.Z,o()({cardBordered:!0,rowKey:h,pagination:o()({showSizeChanger:!0,showQuickJumper:!0},P.pagination),options:!1,request:$,columns:j},P))}function ne(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:120,u={x:0,y:void 0};return n==null||n.forEach(function(d){d.hideInTable||(u.x+=Number(d.width)||t)}),u}var S=e(90037);function x(n){var t=n.name,u=n.desc,d=n.onDelete,c=(0,C.useCallback)(function(){S.Z.confirm({title:"\u786E\u8BA4\u5220\u9664 \u201C".concat(t,"\u201D \u5417\uFF1F"),content:u||"\u5220\u9664\u540E\u4E0D\u53EF\u6062\u590D\uFF0C\u8BF7\u8C28\u614E\u64CD\u4F5C",okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88",onOk:function(){d()}})},[t,u,d]);return{doDelete:c}}function V(n){var t=n.name,u=n.desc,d=n.onDelete,c=(0,C.useCallback)(function(){S.Z.confirm({title:"\u786E\u8BA4\u5220\u9664 \u201C".concat(t,"\u201D \u5417\uFF1F"),content:u||"\u5220\u9664\u540E\u4E0D\u53EF\u6062\u590D\uFF0C\u8BF7\u8C28\u614E\u64CD\u4F5C",okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88",onOk:function(){d()}})},[t,u,d]);return(0,p.jsx)("a",{style:{color:"red"},onClick:c,children:"\u5220\u9664"})}var te=e(48305),J=e.n(te),oe=e(75379),z=e(53992),se=e(33417);function q(n){var t=n.action,u=n.id,d=n.record,c=n.trigger,f=n.onSuccess,h=n.detailForm,P=n.requestGetById,$=n.requestGetByRecord,j=n.requestAdd,b=n.requestUpdateById,ve=n.detailFormInstance,pe=(0,C.useState)(!1),me=J()(pe,2),X=me[0],ce=me[1],de=z.A.useForm(ve),ye=J()(de,1),F=ye[0],Ie=(0,C.useCallback)(function(){var le=_()(R()().mark(function L(Fe){return R()().wrap(function(K){for(;;)switch(K.prev=K.next){case 0:if(K.prev=0,!(t==="create"&&j)){K.next=5;break}return K.next=4,j(Fe);case 4:oe.ZP.open({type:"success",content:"\u521B\u5EFA\u6210\u529F"});case 5:if(!(t==="update"&&b)){K.next=9;break}return K.next=8,b(o()(o()({},Fe),{},{id:u}));case 8:oe.ZP.open({type:"success",content:"\u66F4\u65B0\u6210\u529F"});case 9:return f==null||f(),K.abrupt("return",!0);case 13:K.prev=13,K.t0=K.catch(0),setTimeout(function(){throw K.t0},10);case 16:case"end":return K.stop()}},L,null,[[0,13]])}));return function(L){return le.apply(this,arguments)}}(),[t,j,b,f,u]),N=(0,C.useCallback)(function(le){if(!le){F==null||F.resetFields(),ce(le);return}if(ce(le),u){if(P)return P({id:u}).then(function(L){F==null||F.setFieldsValue(L.data.data)});if($)return $(d).then(function(L){F==null||F.setFieldsValue(L.data.data)})}},[F,u,P,$,d]),w=(0,C.useMemo)(function(){return!X||!h?null:h({readonly:t==="read"&&!!u},{action:t})},[X,h,t,u]);return(0,p.jsxs)(se.a,{form:F,trigger:c,autoFocusFirstInput:!0,onFinish:Ie,onOpenChange:N,layout:"vertical",readonly:t==="read"&&!!u,drawerProps:{destroyOnClose:!0},children:[(0,p.jsx)("div",{className:"h-[20px]"}),w]})}var fe=(0,C.forwardRef)(function(t,u){var d=t.actions,c=t.hmTableProps,f=t.createButton,h=t.deleteProps,P=t.detailIdIndex,$=t.detailForm,j=t.requestGetById,b=t.requestGetByRecord,ve=t.requestAdd,pe=t.requestUpdateById,me=t.detailFormInstance,X=(0,C.useRef)(),ce=(0,I.TH)();(0,C.useImperativeHandle)(u,function(){return{getActionRef:function(){return X}}},[X]);var de=(0,C.useMemo)(function(){return{detailForm:$,requestGetById:j,requestGetByRecord:b,requestAdd:ve,requestUpdateById:pe,detailFormInstance:me}},[$,ve,j,b,pe,me]),ye=(0,C.useCallback)(function(N){return function(){if(h!=null&&h.deleteById)return h.deleteById({id:N.id,ids:[N.id]}).then(function(){var w;(w=X.current)===null||w===void 0||w.reload()});if(h!=null&&h.deleteByRecord)return h.deleteByRecord(N).then(function(){var w;(w=X.current)===null||w===void 0||w.reload()});throw new Error("\u6CA1\u6709\u4F20 deleteById or deleteByRecord")}},[h]),F=(0,C.useCallback)(function(){var N;(N=X.current)===null||N===void 0||N.reload()},[]),Ie=(0,C.useMemo)(function(){var N={title:"\u64CD\u4F5C",fixed:"right",width:120,render:function(le,L){return(0,p.jsxs)(D.Z,{children:[d.includes("read")&&(0,p.jsx)(q,o()({id:L.id,record:L,onSuccess:F,trigger:(0,p.jsx)("a",{children:"\u67E5\u770B"}),action:"read"},de)),d.includes("read_detail")&&(0,p.jsx)(y.rU,{to:"".concat(ce.pathname,"/detail/").concat(L[P||"id"]),children:"\u67E5\u770B"}),d.includes("update")&&(0,p.jsx)(q,o()({id:L.id,record:L,onSuccess:F,trigger:(0,p.jsx)("a",{children:"\u7F16\u8F91"}),action:"update"},de)),d.includes("delete")&&h&&(0,p.jsx)(V,{name:L[h.nameIndex],desc:h.desc,onDelete:ye(L)})]})}};return d.includes("read")||d.includes("read_detail")||d.includes("update")||d.includes("delete")?[].concat(r()(c.hmColumns||c.columns||[]),[N]):c.hmColumns},[d,h,P,de,ye,F,c.columns,c.hmColumns,ce.pathname]);return(0,p.jsx)("div",{className:"",children:(0,p.jsx)(ee,o()(o()({rowKey:"id"},c),{},{scroll:ne(Ie),actionRef:X,toolBarRender:function(){return[].concat(r()(c.toolBarRender?c.toolBarRender.apply(c,arguments):[]),[d.includes("create")&&(0,p.jsx)(q,o()({onSuccess:F,trigger:f||(0,p.jsx)(ae.ZP,{type:"primary",children:"\u65B0\u5EFA"}),action:"create"},de))])},search:o()({layout:"vertical",defaultCollapsed:!1},c.search),hmColumns:Ie}))})}),ie=e(66850),Re=e(28026),Y=e.n(Re),A=["hmItems","items"];function ge(n){var t=n.hmItems,u=n.items,d=M()(n,A),c=(0,C.useMemo)(function(){return t?t.map(function(f){var h=f.children;return f.children!==null&&f.children!==void 0&&(f.valueType==="date"?h=Y()(h).format("YYYY-MM-DD"):f.valueType==="dateTime"?h=Y()(h).format("YYYY-MM-DD HH:mm:ss"):f.valueType==="time"&&(h=Y()(h).format("HH:mm:ss"))),o()(o()({},f),{},{children:h||"-"})}):u},[t,u]);return(0,p.jsx)(ie.Z,o()({items:c},d))}var Ce=e(34019),Pe=e(65273),De=e(59590),xe=e(32479),m={width:"100%",height:"100%"};function g(n){var t=n.value,u=n.onChange,d=n.readonly;return(0,p.jsx)(Ce.ZP,{style:m,mode:"javascript",theme:"monokai",value:t,onChange:u,readOnly:d,name:"javascript_editor",editorProps:{$blockScrolling:!0},setOptions:{enableBasicAutocompletion:!0,enableLiveAutocompletion:!0,enableSnippets:!0,showLineNumbers:!0,tabSize:2}})}var T=e(26494);function i(n){var t=n.value,u=n.onChange,d=n.readonly,c=(0,C.useRef)(null),f=(0,C.useRef)(null),h=(0,C.useRef)(u);return(0,C.useEffect)(function(){var P;(P=f.current)===null||P===void 0||P.update({text:t||""})},[t]),(0,C.useEffect)(function(){f.current=new T.q9({target:c.current,props:{mode:T.AR.text,readOnly:d,content:{text:t||""},onChange:function($){h.current($.text)}}})},[]),(0,p.jsx)("div",{ref:c,className:"h-full w-full"})}var E=e(70876),Q=e(51709),H=["children","className","node"];function G(n){var t=n.value;return(0,p.jsx)(E.U,{unwrapDisallowed:!0,components:{code:function(d){var c=d.children,f=d.className,h=d.node,P=M()(d,H),$=/language-(\w+)/.exec(f||"");return $?(0,p.jsx)(Q.Z,o()(o()({},P),{},{PreTag:"div",wrapLongLines:!0,children:String(c).replace(/\n$/,""),language:$[1].toLowerCase()})):(0,p.jsx)("code",o()(o()({},P),{},{className:f,children:c}))}},children:t||""})}var re=e(55860),Oe=e(12592);function je(n){var t=n.value,u=n.onChange,d=function(h){return u==null||u(h),!1},c=function(){u==null||u(void 0)};return(0,p.jsx)(p.Fragment,{children:(0,p.jsx)(Oe.Z,{name:"file",maxCount:1,showUploadList:!0,fileList:t?[t]:void 0,beforeUpload:d,onRemove:c,children:(0,p.jsx)(ae.ZP,{icon:(0,p.jsx)(re.Z,{}),children:"\u70B9\u51FB\u9009\u62E9\u6587\u4EF6"})})})}var Ue=e(91880),$e=["value","onChange"];function Le(n){var t=n.value,u=n.onChange,d=M()(n,$e);return(0,p.jsx)(Ue.Z,o()(o()({},d),{},{value:!!t,onChange:function(f){return u==null?void 0:u(Number(f))}}))}var Te=e(64934),Se=e(65124),Ne=function(t){return function(u,d,c){var f=(0,Se.mW)(t);return f(u,d,c)}},Ee=Ne,Ke=function(t){return t?(0,Te.Ue)()(Ee(t)):function(u){return(0,Te.Ue)()(Ee(u))}},We=e(82092),Me=e.n(We),Ge=e(85003),He=e(83873);function be(n){return(0,He.Z)(n)&&/^\d+$/.test(n)?Y()(parseInt(n)):Y()(n)}var he=function(n){return n.CustomDateTimeAndDateRange="CustomDateTimeAndDateRange",n.CustomDateAndDateRange="CustomDateAndDateRange",n}(he||{}),Be={dateTime:function(t){return t?(0,p.jsx)("div",{children:be(t).format("YYYY-MM-DD HH:mm:ss")}):"-"},date:function(t){return(0,p.jsx)("div",{children:t?Y()(parseInt(t)).format("YYYY-MM-DD"):"-"})}},Ae={dateRange:function(t,u){return(0,p.jsx)(Ge.Z,o()(o()({},u),{},{fieldProps:o()(o()({},u.fieldProps),{},{onChange:function(c){var f,h,P=c&&[Y()(c[0]).startOf("day"),Y()(c[1]).endOf("day")];(f=(h=u.fieldProps).onChange)===null||f===void 0||f.call(h,P)}})}))}},Ze=Me()(Me()({},he.CustomDateTimeAndDateRange,{render:Be.dateTime,renderFormItem:Ae.dateRange}),he.CustomDateAndDateRange,{render:Be.date,renderFormItem:Ae.dateRange})},28145:function(U,l,e){e.r(l),e.d(l,{texts:function(){return r}});var B=e(95281);const r=[{value:`// commitlint.config.js
module.exports = { extends: ['@huomu/commit-lint'] };
`,paraId:0,tocIndex:0}]},49097:function(U,l,e){e.r(l),e.d(l,{texts:function(){return r}});var B=e(5758);const r=[{value:"\u9700\u8981\u975E\u5E38\u4E86\u89E3 ant pro-components ProForm ProTable",paraId:0,tocIndex:0},{value:"\u57FA\u4E8E ant pro-components \u901A\u7528\u7684 CURD \u7EC4\u4EF6\uFF0C\u540C\u65F6\u4FDD\u7559\u6269\u5C55\u6027\u3002",paraId:1,tocIndex:0},{value:"\u8C03\u6574 actions \u4E3A ",paraId:2,tocIndex:3},{value:"['read_detail']",paraId:2,tocIndex:3},{value:"\uFF0C\u70B9\u51FB<\u67E5\u770B>\u8DF3\u8F6C\u5230 ",paraId:2,tocIndex:3},{value:"xxx/detail/[id]",paraId:2,tocIndex:3},{value:"\uFF0C",paraId:2,tocIndex:3},{value:"\u83B7\u53D6 ProTable \u7684 actionRef",paraId:3,tocIndex:5},{value:"\u901A\u8FC7 ref \u4F60\u53EF\u4EE5\u505A\u66F4\u591A\u64CD\u4F5C",paraId:4,tocIndex:6},{value:`import type { ReactNode } from 'react';
import type { HMTableProps } from '../table';
import type { ProFormInstance, ActionType } from '@ant-design/pro-components';

/**
 * create \u521B\u5EFA
 * read \u67E5\u770B
 * read_detail \u8BE6\u60C5\u9875\u67E5\u770B
 * update \u7F16\u8F91
 * delete \u5220\u9664
 */
type CurdAction = 'create' | 'read' | 'read_detail' | 'update' | 'delete';

interface CURDProps {
  actions: CurdAction[];

  /** \u8868\u683C\u76F8\u5173 */
  hmTableProps: HMTableProps;

  /** \u5220\u9664\u76F8\u5173 */
  deleteProps?: {
    /** \u663E\u793A\u540D\u79F0\u7D22\u5F15 */
    nameIndex: string;
    /** \u5220\u9664\u63A5\u53E3 */
    deleteById?: ({ id, ids }) => Promise<any>;
    deleteByRecord?: (record) => Promise<any>;
    desc?: string;
  };

  /** \u65B0\u5EFA\u6309\u94AE\uFF0C\u9ED8\u8BA4\u65B0\u5EFA */
  createButton?: ReactNode;

  /** \u5F39\u7A97\u8868\u5355 */
  detailForm?: (formProps: { readonly: boolean }, info: { action: CurdAction }) => ReactNode;
  /** detailForm \u7684 formRef */
  detailFormInstance?: ProFormInstance;

  /** \u65B0\u589E\u63A5\u53E3 */
  requestAdd?: (values) => Promise<any>;
  /** \u66F4\u65B0\u63A5\u53E3 */
  requestUpdateById?: (values) => Promise<any>;

  /** \u83B7\u53D6\u8BE6\u60C5\u63A5\u53E3 */
  requestGetById?: ({ id }) => Promise<any>;
  /** \u83B7\u53D6\u8BE6\u60C5\u63A5\u53E3\uFF0C\u975E id \u7684\u65F6\u5019 */
  requestGetByRecord?: (record) => Promise<any>;

  /** \u8DF3\u8F6C\u5230\u8BE6\u60C5\u7684 id \u6240\u4EE5\uFF0C\u9ED8\u8BA4 id */
  detailIdIndex?: string;
}

interface CURDMethods {
  getActionRef: () => React.MutableRefObject<ActionType | undefined>;
}
`,paraId:5,tocIndex:7}]},96147:function(U,l,e){e.r(l),e.d(l,{texts:function(){return r}});var B=e(71492);const r=[{value:"\u81EA\u5B9A\u4E49 valueType",paraId:0,tocIndex:0},{value:`import { customValueTypeMap } from '@huomu/core';
import { ProConfigProvider } from '@ant-design/pro-components';

const Demo = () => (
  <ProConfigProvider valueTypeMap={customValueTypeMap}>
    <div>some</div>
  </ProConfigProvider>
);

export default Demo;
`,paraId:1,tocIndex:1}]},73690:function(U,l,e){e.r(l),e.d(l,{texts:function(){return r}});var B=e(54392);const r=[{value:`// .eslintrc.js
module.exports = {
  extends: ['@huomu/eslint-config-base'],
};
`,paraId:0,tocIndex:0}]},61799:function(U,l,e){e.r(l),e.d(l,{texts:function(){return r}});var B=e(26880);const r=[{value:`Usage: index [options] [command]

Options:
  -V, --version         output the version number
  -h, --help            display help for command

Commands:
  build_api [options]   swagger \u6587\u6863\u751F\u6210 API \u65B9\u6CD5
  build_enum [options]  \u6839\u636E\u679A\u4E3E\u751F\u6210\u4EE3\u7801
  help [command]        display help for command
`,paraId:0,tocIndex:0}]},30226:function(U,l,e){e.r(l),e.d(l,{texts:function(){return r}});var B=e(16606);const r=[{value:`// .stylelintrc.js
module.exports = {
  extends: ['@huomu/style-lint'],
};
`,paraId:0,tocIndex:0}]},32116:function(U,l){l.Z=`import React, { useRef } from 'react';
import { CURD } from '@huomu/core';
import { Button } from 'antd';
import { ProForm, ProFormSwitch, ProFormText } from '@ant-design/pro-components';
import {
  fakeRequest,
  fakeDeleteById,
  fakeAdd,
  fakeGetById,
  fakeUpdateById,
  fakeRequestCity,
  fakeRequestArea,
  levels,
} from './data';

const Normal = () => {
  const hmColumns = [
    {
      title: 'id',
      dataIndex: 'id',
      search: true,
    },
    {
      title: '\u540D\u5B57',
      dataIndex: 'name',
      search: true,
    },
    {
      title: 'city',
      dataIndex: 'city',
    },
    {
      title: 'area',
      dataIndex: 'area',
    },
  ];

  return (
    <CURD
      actions={['create', 'read', 'delete', 'update']}
      hmTableProps={{
        hmColumns,
        hmRequest: fakeRequest,
      }}
      deleteProps={{
        nameIndex: 'name',
        deleteById: fakeDeleteById,
      }}
      detailForm={(formProps) => (
        <>
          <ProFormText
            {...formProps}
            name="name"
            label="\u540D\u5B57"
            required
            rules={[{ required: true }]}
          />
        </>
      )}
      requestGetById={fakeGetById}
      requestAdd={fakeAdd}
      requestUpdateById={fakeUpdateById}
    />
  );
};

function ReadDetail() {
  const hmColumns = [
    {
      title: 'id',
      dataIndex: 'id',
      search: true,
    },
    {
      title: '\u540D\u5B57',
      dataIndex: 'name',
      search: true,
    },
  ];

  return (
    <CURD
      actions={['read_detail']}
      hmTableProps={{
        hmColumns,
        hmRequest: fakeRequest,
      }}
    />
  );
}

function Ref() {
  const formRef = useRef<any>();
  const [detailFormInstance] = ProForm.useForm();

  window._detailFormInstance = detailFormInstance;

  const name = ProForm.useWatch('name', formRef.current);
  const detailName = ProForm.useWatch('name', detailFormInstance);

  // \u4E0D\u77E5\u9053\u4E3A\u5565\u8FD9\u91CC name \u4E0D\u751F\u6548\uFF0C\u4F46\u662F\u9879\u76EE\u91CC\u662F\u751F\u6548\u7684\u3002\u5148\u5FFD\u7565
  console.log('useWatch', name, detailName);

  const hmColumns = [
    {
      title: 'id',
      dataIndex: 'id',
      search: true,
    },
    {
      title: '\u540D\u5B57',
      dataIndex: 'name',
      search: true,
    },
  ];

  return (
    <CURD
      actions={['create', 'read', 'update']}
      hmTableProps={{
        formRef,
        hmColumns,
        hmRequest: fakeRequest,
      }}
      detailFormInstance={detailFormInstance}
      detailForm={(formProps) => (
        <>
          <ProFormText
            {...formProps}
            name="name"
            label="\u540D\u5B57"
            required
            rules={[{ required: true }]}
            initialValue={'default'}
          />
          <ProFormSwitch {...formProps} name="status" label="\u5F00\u542F" initialValue={false} />
        </>
      )}
      requestGetById={fakeGetById}
      requestAdd={fakeAdd}
      requestUpdateById={fakeUpdateById}
    />
  );
}

function ActionRef() {
  const ref = useRef<any>();

  const hmColumns = [
    {
      title: 'id',
      dataIndex: 'id',
      search: true,
    },
    {
      title: '\u540D\u5B57',
      dataIndex: 'name',
      search: true,
    },
  ];

  return (
    <>
      <Button onClick={() => ref.current.getActionRef().current?.reload()}>reload</Button>
      <CURD
        ref={ref}
        actions={[]}
        hmTableProps={{
          hmColumns,
          hmRequest: fakeRequest,
        }}
      />
    </>
  );
}

function RemoteData() {
  const hmColumns = [
    {
      title: 'id',
      dataIndex: 'id',
      search: true,
    },
    {
      title: '\u540D\u5B57',
      dataIndex: 'name',
      search: true,
    },
    {
      title: '\u7B49\u7EA7',
      dataIndex: 'level',
      search: true,
      valueEnum: levels,
    },
    {
      title: 'city',
      dataIndex: 'city',
      search: true,
      request: async () => {
        const res = await fakeRequestCity();

        return (
          res.map((item) => ({
            label: item,
            value: item,
          })) || []
        );
      },
    },
    {
      title: 'area',
      dataIndex: 'area',
      search: true,
      request: async (params) => {
        console.log('params', params);
        const res = await fakeRequestArea(params);

        return (
          res.map((item) => ({
            label: item,
            value: item,
          })) || []
        );
      },
      dependencies: ['city'],
    },
  ];

  return (
    <CURD
      actions={[]}
      hmTableProps={{
        hmColumns,
        hmRequest: fakeRequest,
      }}
    />
  );
}

export { Normal, ReadDetail, Ref, ActionRef, RemoteData };
`}}]);
